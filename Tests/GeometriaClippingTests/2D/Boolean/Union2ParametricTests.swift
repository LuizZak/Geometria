import Geometria
import TestCommons
import XCTest

@testable import GeometriaClipping

class Union2ParametricTests: XCTestCase {
    let accuracy: Double = 1e-12

    func testUnion_vennDiagram() {
        let lhs = Circle2Parametric.makeTestCircle(center: .init(x: -90, y: 0), radius: 200)
        let rhs = Circle2Parametric.makeTestCircle(center: .init(x:  90, y: 0), radius: 200)
        let sut = Union2Parametric(lhs, rhs, tolerance: accuracy)

        TestFixture.beginFixture(lineScale: 1.0) { fixture in
            fixture.add(lhs, category: "input 1")
            fixture.add(rhs, category: "input 2")

            fixture.assertions(on: sut)
                .assertAllSimplexes(
                    accuracy: accuracy,
                    [[GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: -90.0, y: 0.0), radius: 200.0, startAngle: Angle<Double>(radians: 1.1040309877476002), sweepAngle: Angle<Double>(radians: 0.4667653390472963)), startPeriod: 0.0, endPeriod: 0.05727008743737412)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: -90.0, y: 0.0), radius: 200.0, startAngle: Angle<Double>(radians: 1.5707963267948966), sweepAngle: Angle<Double>(radians: 1.5707963267948966)), startPeriod: 0.05727008743737412, endPeriod: 0.24999999999999997)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: -90.0, y: 0.0), radius: 200.0, startAngle: Angle<Double>(radians: 3.141592653589793), sweepAngle: Angle<Double>(radians: 1.5707963267948966)), startPeriod: 0.24999999999999997, endPeriod: 0.4427299125626258)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: -90.0, y: 0.0), radius: 200.0, startAngle: Angle<Double>(radians: 4.71238898038469), sweepAngle: Angle<Double>(radians: 0.46676533904729645)), startPeriod: 0.4427299125626258, endPeriod: 0.49999999999999994)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: 90.0, y: 0.0), radius: 200.0, startAngle: Angle<Double>(radians: 4.245623641337393), sweepAngle: Angle<Double>(radians: 0.46676533904729645)), startPeriod: 0.49999999999999994, endPeriod: 0.557270087437374)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: 90.0, y: 0.0), radius: 200.0, startAngle: Angle<Double>(radians: 4.71238898038469), sweepAngle: Angle<Double>(radians: 1.5707963267948966)), startPeriod: 0.557270087437374, endPeriod: 0.7499999999999999)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: 90.0, y: 0.0), radius: 200.0, startAngle: Angle<Double>(radians: 0.0), sweepAngle: Angle<Double>(radians: 1.5707963267948966)), startPeriod: 0.7499999999999999, endPeriod: 0.9427299125626258)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: 90.0, y: 0.0), radius: 200.0, startAngle: Angle<Double>(radians: 1.5707963267948966), sweepAngle: Angle<Double>(radians: 0.46676533904729645)), startPeriod: 0.9427299125626258, endPeriod: 1.0))]]
                )
        }
    }

    func testUnion_lhsContainsRhs() {
        let lhs = Circle2Parametric.makeTestCircle(radius: 100.0)
        let rhs = Circle2Parametric.makeTestCircle(radius: 80.0)
        let sut = Union2Parametric(lhs, rhs, tolerance: accuracy)

        TestFixture.beginFixture { fixture in
            fixture.assertions(on: sut)
                .assertAllSimplexes(
                    accuracy: accuracy,
                    [lhs.allSimplexes()]
                )
        }
    }

    func testUnion_rhsContainsLhs() {
        let lhs = Circle2Parametric.makeTestCircle(radius: 80.0)
        let rhs = Circle2Parametric.makeTestCircle(radius: 100.0)
        let sut = Union2Parametric(lhs, rhs, tolerance: accuracy)

        TestFixture.beginFixture { fixture in
            fixture.assertions(on: sut)
                .assertAllSimplexes(
                    accuracy: accuracy,
                    [rhs.allSimplexes()]
                )
        }
    }

    func testUnion_noIntersectionOrContainment() {
        let lhs = Circle2Parametric.makeTestCircle(center: .init(x: -100, y: 0), radius: 50.0)
        let rhs = Circle2Parametric.makeTestCircle(center: .init(x: 100, y: 0), radius: 50.0)
        let sut = Union2Parametric(lhs, rhs, tolerance: accuracy)

        TestFixture.beginFixture { fixture in
            fixture.assertions(on: sut)
                .assertAllSimplexes(
                    accuracy: accuracy,
                    [lhs.allSimplexes(), rhs.allSimplexes()]
                )
        }
    }

    func testUnion_lines_lines() {
        let lhs = LinePolygon2Parametric.makeStar()
        let rhs = LinePolygon2Parametric.makeHexagon(radius: 80.0)
        let sut = Union2Parametric(lhs, rhs, tolerance: accuracy)

        TestFixture.beginFixture(renderScale: 2.0) { fixture in
            fixture.assertions(on: sut)
                .assertAllSimplexes(
                    accuracy: accuracy,
                    [[GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: 100.0, y: 0.0), end: Vector2<Double>(x: 74.9785189589521, y: 8.697460292338837)), startPeriod: 0.0, endPeriod: 0.0392255056302415)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: 74.9785189589521, y: 8.697460292338837), end: Vector2<Double>(x: 40.00000000000001, y: 69.28203230275508)), startPeriod: 0.0392255056302415, endPeriod: 0.14281552967403852)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: 40.00000000000001, y: 69.28203230275508), end: Vector2<Double>(x: 31.42794501299971, y: 69.28203230275507)), startPeriod: 0.14281552967403852, endPeriod: 0.15550873980180535)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: 31.42794501299971, y: 69.28203230275507), end: Vector2<Double>(x: 30.901699437494745, y: 95.10565162951535)), startPeriod: 0.15550873980180535, endPeriod: 0.1937554240880302)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: 30.901699437494745, y: 95.10565162951535), end: Vector2<Double>(x: 11.323626827162714, y: 69.28203230275508)), startPeriod: 0.1937554240880302, endPeriod: 0.24174139733448927)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: 11.323626827162714, y: 69.28203230275508), end: Vector2<Double>(x: -39.999999999999986, y: 69.2820323027551)), startPeriod: 0.24174139733448927, endPeriod: 0.3177396942217845)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: -39.999999999999986, y: 69.2820323027551), end: Vector2<Double>(x: -51.244447041333736, y: 49.80607872414753)), startPeriod: 0.3177396942217845, endPeriod: 0.3510404906545292)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: -51.244447041333736, y: 49.80607872414753), end: Vector2<Double>(x: -80.90169943749473, y: 58.77852522924732)), startPeriod: 0.3510404906545292, endPeriod: 0.39692172832110456)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: -80.90169943749473, y: 58.77852522924732), end: Vector2<Double>(x: -61.86160744855665, y: 31.41661746672879)), startPeriod: 0.39692172832110456, endPeriod: 0.4462825592265689)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: -61.86160744855665, y: 31.41661746672879), end: Vector2<Double>(x: -80.0, y: 9.797174393178826e-15)), startPeriod: 0.4462825592265689, endPeriod: 0.5)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: -80.0, y: 9.797174393178826e-15), end: Vector2<Double>(x: -61.86160744855664, y: -31.416617466728745)), startPeriod: 0.5, endPeriod: 0.5537174407734311)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: -61.86160744855664, y: -31.416617466728745), end: Vector2<Double>(x: -80.90169943749476, y: -58.7785252292473)), startPeriod: 0.5537174407734311, endPeriod: 0.6030782716788955)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: -80.90169943749476, y: -58.7785252292473), end: Vector2<Double>(x: -51.24444704133376, y: -49.80607872414752)), startPeriod: 0.6030782716788955, endPeriod: 0.648959509345471)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: -51.24444704133376, y: -49.80607872414752), end: Vector2<Double>(x: -40.000000000000036, y: -69.28203230275507)), startPeriod: 0.648959509345471, endPeriod: 0.6822603057782156)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: -40.000000000000036, y: -69.28203230275507), end: Vector2<Double>(x: 11.323626827162698, y: -69.28203230275508)), startPeriod: 0.6822603057782156, endPeriod: 0.7582586026655108)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: 11.323626827162698, y: -69.28203230275508), end: Vector2<Double>(x: 30.901699437494724, y: -95.10565162951536)), startPeriod: 0.7582586026655108, endPeriod: 0.8062445759119699)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: 30.901699437494724, y: -95.10565162951536), end: Vector2<Double>(x: 31.427945012999693, y: -69.28203230275513)), startPeriod: 0.8062445759119699, endPeriod: 0.8444912601981946)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: 31.427945012999693, y: -69.28203230275513), end: Vector2<Double>(x: 40.00000000000001, y: -69.28203230275508)), startPeriod: 0.8444912601981946, endPeriod: 0.8571844703259616)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: 40.00000000000001, y: -69.28203230275508), end: Vector2<Double>(x: 74.97851895895208, y: -8.697460292338846)), startPeriod: 0.8571844703259616, endPeriod: 0.9607744943697585)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: 74.97851895895208, y: -8.697460292338846), end: Vector2<Double>(x: 100.0, y: 0.0)), startPeriod: 0.9607744943697585, endPeriod: 1.0))]]
                )
        }
    }

    func testUnion_lines_arcs() {
        let lhs = LinePolygon2Parametric.makeHexagon()
        let rhs = Circle2Parametric.makeTestCircle(radius: 95)

        let sut = Union2Parametric(lhs, rhs, tolerance: accuracy)

        TestFixture.beginFixture(renderScale: 2.0) { fixture in
            fixture.assertions(on: sut)
                .assertAllSimplexes(
                    accuracy: accuracy,
                    [[GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: 100.0, y: 0.0), end: Vector2<Double>(x: 94.52562418976665, y: 9.481897043050221)), startPeriod: 0.0, endPeriod: 0.017822696814540084)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: 0.0, y: 0.0), radius: 95.0, startAngle: Angle<Double>(radians: 0.09997590556877552), sweepAngle: Angle<Double>(radians: 0.8472457400590464)), startPeriod: 0.017822696814540084, endPeriod: 0.14884396985212653)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: 55.47437581023338, y: 77.12064333539362), end: Vector2<Double>(x: 50.000000000000014, y: 86.60254037844386)), startPeriod: 0.14884396985212653, endPeriod: 0.16666666666666663)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: 50.000000000000014, y: 86.60254037844386), end: Vector2<Double>(x: 39.051248379533256, y: 86.60254037844386)), startPeriod: 0.16666666666666663, endPeriod: 0.1844893634812068)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: 0.0, y: 0.0), radius: 95.0, startAngle: Angle<Double>(radians: 1.1471734567653735), sweepAngle: Angle<Double>(radians: 0.8472457400590461)), startPeriod: 0.1844893634812068, endPeriod: 0.31551063651879313)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: -39.05124837953323, y: 86.60254037844388), end: Vector2<Double>(x: -49.99999999999998, y: 86.60254037844388)), startPeriod: 0.31551063651879313, endPeriod: 0.33333333333333326)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: -49.99999999999998, y: 86.60254037844388), end: Vector2<Double>(x: -55.47437581023333, y: 77.12064333539367)), startPeriod: 0.33333333333333326, endPeriod: 0.35115603014787333)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: 0.0, y: 0.0), radius: 95.0, startAngle: Angle<Double>(radians: 2.194371007961971), sweepAngle: Angle<Double>(radians: 0.8472457400590464)), startPeriod: 0.35115603014787333, endPeriod: 0.4821773031854597)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: -94.52562418976665, y: 9.481897043050228), end: Vector2<Double>(x: -100.0, y: 1.2246467991473532e-14)), startPeriod: 0.4821773031854597, endPeriod: 0.49999999999999983)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: -100.0, y: 1.2246467991473532e-14), end: Vector2<Double>(x: -94.52562418976665, y: -9.481897043050205)), startPeriod: 0.49999999999999983, endPeriod: 0.51782269681454)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: 0.0, y: 0.0), radius: 95.0, startAngle: Angle<Double>(radians: 3.241568559158569), sweepAngle: Angle<Double>(radians: 0.8472457400590453)), startPeriod: 0.51782269681454, endPeriod: 0.6488439698521262)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: -55.4743758102334, y: -77.12064333539361), end: Vector2<Double>(x: -50.00000000000004, y: -86.60254037844383)), startPeriod: 0.6488439698521262, endPeriod: 0.6666666666666663)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: -50.00000000000004, y: -86.60254037844383), end: Vector2<Double>(x: -39.051248379533334, y: -86.60254037844383)), startPeriod: 0.6666666666666663, endPeriod: 0.6844893634812064)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: 0.0, y: 0.0), radius: 95.0, startAngle: Angle<Double>(radians: 4.288766110355166), sweepAngle: Angle<Double>(radians: 0.8472457400590481)), startPeriod: 0.6844893634812064, endPeriod: 0.8155106365187931)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: 39.05124837953331, y: -86.60254037844386), end: Vector2<Double>(x: 50.000000000000014, y: -86.60254037844386)), startPeriod: 0.8155106365187931, endPeriod: 0.8333333333333331)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: 50.000000000000014, y: -86.60254037844386), end: Vector2<Double>(x: 55.47437581023337, y: -77.12064333539365)), startPeriod: 0.8333333333333331, endPeriod: 0.8511560301478732)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: 0.0, y: 0.0), radius: 95.0, startAngle: Angle<Double>(radians: 5.335963661551764), sweepAngle: Angle<Double>(radians: 0.8472457400590474)), startPeriod: 0.8511560301478732, endPeriod: 0.9821773031854599)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: 94.52562418976665, y: -9.481897043050214), end: Vector2<Double>(x: 100.0, y: 0.0)), startPeriod: 0.9821773031854599, endPeriod: 1.0))]]
                )
        }
    }

    func testUnion_arcsArcs() {
        let lhs = Circle2Parametric.makeTestCircle(center: .init(x: -25.0, y: 5.0), radius: 115)
        let rhs = Circle2Parametric.makeTestCircle(center: .init(x: 25.0, y: -5.0), radius: 85)

        let sut = Union2Parametric(lhs, rhs, tolerance: 1e-14)

        TestFixture.beginFixture { fixture in
            fixture.assertions(on: sut)
                .assertAllSimplexes(
                    accuracy: accuracy,
                    [[GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: -25.0, y: 5.0), radius: 115.0, startAngle: Angle<Double>(radians: 0.5502322143364249), sweepAngle: Angle<Double>(radians: 1.0205641124584717)), startPeriod: 0.0, endPeriod: 0.1566687353278738)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: -25.0, y: 5.0), radius: 115.0, startAngle: Angle<Double>(radians: 1.5707963267948966), sweepAngle: Angle<Double>(radians: 1.5707963267948966)), startPeriod: 0.1566687353278738, endPeriod: 0.39780466297067535)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: -25.0, y: 5.0), radius: 115.0, startAngle: Angle<Double>(radians: 3.141592653589793), sweepAngle: Angle<Double>(radians: 1.5707963267948966)), startPeriod: 0.39780466297067535, endPeriod: 0.6389405906134769)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: -25.0, y: 5.0), radius: 115.0, startAngle: Angle<Double>(radians: 4.71238898038469), sweepAngle: Angle<Double>(radians: 0.6257729927587105)), startPeriod: 0.6389405906134769, endPeriod: 0.7350041913035661)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: 25.0, y: -5.0), radius: 85.0, startAngle: Angle<Double>(radians: 4.918050495000922), sweepAngle: Angle<Double>(radians: 1.3651348121786642)), startPeriod: 0.7350041913035661, endPeriod: 0.8898996454092252)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: 25.0, y: -5.0), radius: 85.0, startAngle: Angle<Double>(radians: 0.0), sweepAngle: Angle<Double>(radians: 0.9703436924789027)), startPeriod: 0.8898996454092252, endPeriod: 1.0))]]
                )
        }
    }

    func testUnion_concaveShape() {
        let lhs = LinePolygon2Parametric.makeCShape()
        let rhs = LinePolygon2Parametric.makeRectangle(width: 10, height: 120)
        let sut = Union2Parametric(lhs, rhs, tolerance: accuracy)

        TestFixture.beginFixture(renderScale: 2) { fixture in
            fixture.assertions(on: sut)
                .assertAllSimplexes(
                    accuracy: accuracy,
                    [[GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: -50.0, y: -50.0), end: Vector2<Double>(x: -4.999999999999999, y: -50.0)), startPeriod: 0.0, endPeriod: 0.08883299341559671)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: -4.999999999999999, y: -50.0), end: Vector2<Double>(x: -5.0, y: -60.0)), startPeriod: 0.08883299341559671, endPeriod: 0.10857365861906265)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: -5.0, y: -60.0), end: Vector2<Double>(x: 5.0, y: -60.0)), startPeriod: 0.10857365861906265, endPeriod: 0.12831432382252858)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: 5.0, y: -60.0), end: Vector2<Double>(x: 5.000000000000005, y: -50.0)), startPeriod: 0.12831432382252858, endPeriod: 0.1480549890259945)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: 5.000000000000005, y: -50.0), end: Vector2<Double>(x: 50.0, y: -50.0)), startPeriod: 0.1480549890259945, endPeriod: 0.23688798244159123)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: 50.0, y: -50.0), end: Vector2<Double>(x: 30.0, y: -30.0)), startPeriod: 0.23688798244159123, endPeriod: 0.29272301536360756)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: 30.0, y: -30.0), end: Vector2<Double>(x: 4.999999999999982, y: -30.0)), startPeriod: 0.29272301536360756, endPeriod: 0.34207467837227246)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: 4.999999999999982, y: -30.0), end: Vector2<Double>(x: 4.999999999999993, y: 30.0)), startPeriod: 0.34207467837227246, endPeriod: 0.4605186695930681)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: 4.999999999999993, y: 30.0), end: Vector2<Double>(x: 30.0, y: 30.0)), startPeriod: 0.4605186695930681, endPeriod: 0.509870332601733)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: 30.0, y: 30.0), end: Vector2<Double>(x: 50.0, y: 50.0)), startPeriod: 0.509870332601733, endPeriod: 0.5657053655237493)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: 50.0, y: 50.0), end: Vector2<Double>(x: 4.999999999999977,y: 50.0)), startPeriod: 0.5657053655237493, endPeriod: 0.654538358939346)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: 4.999999999999977, y: 50.0), end: Vector2<Double>(x: 5.0, y: 60.0)), startPeriod: 0.654538358939346, endPeriod: 0.6742790241428119)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: 5.0, y: 60.0), end: Vector2<Double>(x: -5.0, y: 60.0)), startPeriod: 0.6742790241428119, endPeriod: 0.6940196893462779)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: -5.0, y: 60.0), end: Vector2<Double>(x: -4.999999999999975, y: 50.0)), startPeriod: 0.6940196893462779, endPeriod: 0.7137603545497438)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: -4.999999999999975, y: 50.0), end: Vector2<Double>(x: -50.0, y: 50.0)), startPeriod: 0.7137603545497438, endPeriod: 0.8025933479653407)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: -50.0, y: 50.0), end: Vector2<Double>(x: -50.0, y: -50.0)), startPeriod: 0.8025933479653407, endPeriod: 1.0))], [GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: -5.000000000000002, y: -30.0), end: Vector2<Double>(x: -30.0, y: -30.0)), startPeriod: 0.0, endPeriod: 0.1470588235294118)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: -30.0, y: -30.0), end: Vector2<Double>(x: -30.0, y: 30.0)), startPeriod: 0.1470588235294118, endPeriod: 0.5000000000000001)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: -30.0, y: 30.0), end: Vector2<Double>(x: -5.000000000000022, y: 30.0)), startPeriod: 0.5000000000000001, endPeriod: 0.6470588235294117)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: -5.000000000000022, y: 30.0), end: Vector2<Double>(x: -5.000000000000002, y: -30.0)), startPeriod: 0.6470588235294117, endPeriod: 1.0))]]
                )
        }
    }

    func testUnion_intersectionOnStartPeriod() {
        let lhs = Circle2Parametric.makeTestCircle()
        let rhs = LinePolygon2Parametric.makeRectangle(
            width: 220,
            height: 220,
            center: .init(x: 0.0, y: -110.0)
        )
        let sut = Union2Parametric(lhs, rhs)

        TestFixture.beginFixture(renderScale: 2) { fixture in
            fixture.assertions(on: sut)
                .assertAllSimplexes(
                    accuracy: accuracy,
                    [[GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: 0.0, y: 0.0), radius: 100.0, startAngle: Angle<Double>(radians: 0.0), sweepAngle: Angle<Double>(radians: 1.5707963267948966)), startPeriod: 0.0, endPeriod: 0.158002483256815)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: 0.0, y: 0.0), radius: 100.0, startAngle: Angle<Double>(radians: 1.5707963267948966), sweepAngle: Angle<Double>(radians: 1.5707963267948966)), startPeriod: 0.158002483256815, endPeriod: 0.31600496651363)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: -100.0, y: 1.2246467991473532e-14), end: Vector2<Double>(x: -110.0, y: 0.0)), startPeriod: 0.31600496651363, endPeriod: 0.32606371700607667)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: -110.0, y: 0.0), end: Vector2<Double>(x: -110.0, y: -220.0)), startPeriod: 0.32606371700607667, endPeriod: 0.5473562278399022)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: -110.0, y: -220.0), end: Vector2<Double>(x: 110.0, y: -220.0)), startPeriod: 0.5473562278399022, endPeriod: 0.7686487386737278)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: 110.0, y: -220.0), end: Vector2<Double>(x: 110.0, y: 0.0)), startPeriod: 0.7686487386737278, endPeriod: 0.9899412495075534)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: 110.0, y: 0.0), end: Vector2<Double>(x: 100.0, y: 0.0)), startPeriod: 0.9899412495075534, endPeriod: 1.0))]]
                )
        }
    }

    func testUnion_rhsOccludesLhsHole() {
        let radius: Double = 50.0
        let circles = [
            Circle2Parametric.makeTestCircle(center: .init(x: 0, y: 55), radius: radius),
            Circle2Parametric.makeTestCircle(center: .init(x: -47, y: -29), radius: radius),
            Circle2Parametric.makeTestCircle(center: .init(x: 48, y: -27), radius: radius),
        ]
        let lhs = union(tolerance: accuracy, circles)
        let rhs = Circle2Parametric.makeTestCircle(center: .init(x: 0, y: 0), radius: radius)
        let sut: Union2Parametric = Union2Parametric(lhs, rhs, tolerance: accuracy)

        TestFixture.beginFixture { fixture in
            fixture.add(circles[0], category: "input 1")
            fixture.add(circles[1], category: "input 1")
            fixture.add(circles[2], category: "input 1")
            fixture.add(rhs, category: "input 2")

            fixture.assertions(on: sut)
                .assertAllSimplexes(
                    accuracy: accuracy,
                    [[GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: 0.0, y: 55.0), radius: 50.0, startAngle: Angle<Double>(radians: 0.0), sweepAngle: Angle<Double>(radians: 1.5707963267948966)), startPeriod: 0.0, endPeriod: 0.11823023429846431)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: 0.0, y: 55.0), radius: 50.0, startAngle: Angle<Double>(radians: 1.5707963267948966), sweepAngle: Angle<Double>(radians: 1.5707963267948966)), startPeriod: 0.11823023429846431, endPeriod: 0.23646046859692862)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: 0.0, y: 55.0), radius: 50.0, startAngle: Angle<Double>(radians: 3.141592653589793), sweepAngle: Angle<Double>(radians: 0.5823642378687436)), startPeriod: 0.23646046859692862, endPeriod: 0.28029368816573047)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: 0.0, y: 0.0), radius: 50.0, startAngle: Angle<Double>(radians: 2.5592284157210496), sweepAngle: Angle<Double>(radians: 0.1494914997131486)), startPeriod: 0.28029368816573047, endPeriod: 0.2915455702431337)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: -47.0, y: -29.0), radius: 50.0, startAngle: Angle<Double>(radians: 1.5385551813406735), sweepAngle: Angle<Double>(radians: 0.03224114545422309)), startPeriod: 0.2915455702431337, endPeriod: 0.2939722872630809)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: -47.0, y: -29.0), radius: 50.0, startAngle: Angle<Double>(radians: 1.5707963267948966), sweepAngle: Angle<Double>(radians: 1.5707963267948966)), startPeriod: 0.2939722872630809, endPeriod: 0.41220252156154524)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: -47.0, y: -29.0), radius: 50.0, startAngle: Angle<Double>(radians: 3.141592653589793), sweepAngle: Angle<Double>(radians: 1.5707963267948966)), startPeriod: 0.41220252156154524, endPeriod: 0.5304327558600096)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: -47.0, y: -29.0), radius: 50.0, startAngle: Angle<Double>(radians: 4.71238898038469), sweepAngle: Angle<Double>(radians: 1.1379235886393009)), startPeriod: 0.5304327558600096, endPeriod: 0.6160816526670752)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: 0.0, y: 0.0), radius: 50.0, startAngle: Angle<Double>(radians: 4.680147834930466), sweepAngle: Angle<Double>(radians: 0.1030864112323703)), startPeriod: 0.6160816526670752, endPeriod: 0.6238407302413522)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: 48.0, y: -27.0), radius: 50.0, startAngle: Angle<Double>(radians: 3.616764793985068), sweepAngle: Angle<Double>(radians: 1.095624186399622)), startPeriod: 0.6238407302413522, endPeriod: 0.7063058481254771)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: 48.0, y: -27.0), radius: 50.0, startAngle: Angle<Double>(radians: 4.71238898038469), sweepAngle: Angle<Double>(radians: 1.5707963267948966)), startPeriod: 0.7063058481254771, endPeriod: 0.8245360824239414)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: 48.0, y: -27.0), radius: 50.0, startAngle: Angle<Double>(radians: 0.0), sweepAngle: Angle<Double>(radians: 1.5707963267948966)), startPeriod: 0.8245360824239414, endPeriod: 0.9427663167224056)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: 48.0, y: -27.0), radius: 50.0, startAngle: Angle<Double>(radians: 1.5707963267948966), sweepAngle: Angle<Double>(radians: 0.07084526577814718)), startPeriod: 0.9427663167224056, endPeriod: 0.9480986772767356)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: 0.0, y: 0.0), radius: 50.0, startAngle: Angle<Double>(radians: 0.4751721403952749), sweepAngle: Angle<Double>(radians: 0.10719209747346861)), startPeriod: 0.9480986772767356, endPeriod: 0.9561667804311981)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: 0.0, y: 55.0), radius: 50.0, startAngle: Angle<Double>(radians: 5.700821069310844), sweepAngle: Angle<Double>(radians: 0.5823642378687433)), startPeriod: 0.9561667804311981, endPeriod: 1.0))]]
                )
        }
    }

    func testUnion_lhsOccludesRhsHole() {
        let lhs = Circle2Parametric.makeTestCircle(radius: 90.0)
        let rhs1 = Circle2Parametric.makeTestCircle(radius: 100.0)
        let rhs2 = Circle2Parametric.makeTestCircle(radius: 80.0)
        let rhs = Compound2Parametric(contours: Subtraction2Parametric(rhs1, rhs2).allContours())
        let sut = Union2Parametric(lhs, rhs, tolerance: accuracy)

        TestFixture.beginFixture { fixture in
            fixture.assertions(on: sut)
                .assertAllSimplexes(
                    accuracy: accuracy,
                    [[GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: 0.0, y: 0.0), radius: 100.0, startAngle: Angle<Double>(radians: 0.0), sweepAngle: Angle<Double>(radians: 1.5707963267948966)), startPeriod: 0.0, endPeriod: 0.25)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: 0.0, y: 0.0), radius: 100.0, startAngle: Angle<Double>(radians: 1.5707963267948966), sweepAngle: Angle<Double>(radians: 1.5707963267948966)), startPeriod: 0.25, endPeriod: 0.5)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: 0.0, y: 0.0), radius: 100.0, startAngle: Angle<Double>(radians: 3.141592653589793), sweepAngle: Angle<Double>(radians: 1.5707963267948966)), startPeriod: 0.5, endPeriod: 0.75)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: 0.0, y: 0.0), radius: 100.0, startAngle: Angle<Double>(radians: 4.71238898038469), sweepAngle: Angle<Double>(radians: 1.5707963267948966)), startPeriod: 0.75, endPeriod: 1.0))]]
                )
        }
    }

    func testUnion_lhsIntersectsRhsHole() {
        let lhs = Circle2Parametric.makeTestCircle(center: .init(x: -25, y: 30), radius: 90.0)
        let rhs1 = Circle2Parametric.makeTestCircle(radius: 100.0)
        let rhs2 = Circle2Parametric.makeTestCircle(radius: 80.0)
        let rhs = Compound2Parametric(contours: Subtraction2Parametric(rhs1, rhs2).allContours())
        let sut = Union2Parametric(lhs, rhs, tolerance: accuracy)

        TestFixture.beginFixture { fixture in
            fixture.assertions(on: sut)
                .assertAllSimplexes(
                    accuracy: accuracy,
                    [[GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: -25.0, y: 30.0), radius: 90.0, startAngle: Angle<Double>(radians: 0.0), sweepAngle: Angle<Double>(radians: 0.21809540834932092)), startPeriod: 0.0, endPeriod: 0.044229133319407615)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: 0.0, y: 0.0), radius: 80.0, startAngle: Angle<Double>(radians: 0.6667265455881081), sweepAngle: Angle<Double>(radians: -0.6667265455881081)), startPeriod: 0.044229133319407615, endPeriod: 0.1644160327465621)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: 0.0, y: 0.0), radius: 80.0, startAngle: Angle<Double>(radians: 6.283185307179586), sweepAngle: Angle<Double>(radians: -1.5707963267948966)), startPeriod: 0.1644160327465621, endPeriod: 0.4475743101517527)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: 0.0, y: 0.0), radius: 80.0, startAngle: Angle<Double>(radians: 4.71238898038469), sweepAngle: Angle<Double>(radians: -0.8480463199895979)), startPeriod: 0.4475743101517527, endPeriod: 0.6004466660593052)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: -25.0, y: 30.0), radius: 90.0, startAngle: Angle<Double>(radians: 4.312973797633879), sweepAngle: Angle<Double>(radians: 0.3994151827508109)), startPeriod: 0.6004466660593052, endPeriod: 0.6814469379191606)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: -25.0, y: 30.0), radius: 90.0, startAngle: Angle<Double>(radians: 4.71238898038469), sweepAngle: Angle<Double>(radians: 1.5707963267948966)), startPeriod: 0.6814469379191606, endPeriod: 1.0))], [GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: -25.0, y: 30.0), radius: 90.0, startAngle: Angle<Double>(radians: 0.7481123144455527), sweepAngle: Angle<Double>(radians: 0.822684012349344)), startPeriod: 0.0, endPeriod: 0.10919184265307214)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: -25.0, y: 30.0), radius: 90.0, startAngle: Angle<Double>(radians: 1.5707963267948966), sweepAngle: Angle<Double>(radians: 1.5707963267948966)), startPeriod: 0.10919184265307214, endPeriod: 0.317677899001252)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: -25.0, y: 30.0), radius: 90.0, startAngle: Angle<Double>(radians: 3.141592653589793), sweepAngle: Angle<Double>(radians: 0.6413642379478535)), startPeriod: 0.317677899001252, endPeriod: 0.40280383058866603)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: 0.0, y: 0.0), radius: 100.0, startAngle: Angle<Double>(radians: 3.3823726779139887), sweepAngle: Angle<Double>(radians: 1.330016302470701)), startPeriod: 0.40280383058866603, endPeriod: 0.5989462790262653)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: 0.0, y: 0.0), radius: 100.0, startAngle: Angle<Double>(radians: 4.71238898038469), sweepAngle: Angle<Double>(radians: 1.5707963267948966)), startPeriod: 0.5989462790262653, endPeriod: 0.8305974527464651)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: 0.0, y: 0.0), radius: 100.0, startAngle: Angle<Double>(radians: 0.0), sweepAngle: Angle<Double>(radians: 1.1486965280692114)), startPeriod: 0.8305974527464651, endPeriod: 1.0))]]
                )
        }
    }

    func testUnion_rhsIntersectsLhsHole() {
        let lhs1 = Circle2Parametric.makeTestCircle(radius: 100.0)
        let lhs2 = Circle2Parametric.makeTestCircle(radius: 80.0)
        let lhs = Compound2Parametric(contours: Subtraction2Parametric(lhs1, lhs2).allContours())
        let rhs = Circle2Parametric.makeTestCircle(center: .init(x: -25, y: 30), radius: 90.0)
        let sut = Union2Parametric(lhs, rhs, tolerance: accuracy)

        TestFixture.beginFixture { fixture in
            fixture.assertions(on: sut)
                .assertAllSimplexes(
                    accuracy: accuracy,
                    [[GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: 0.0, y: 0.0), radius: 100.0, startAngle: Angle<Double>(radians: 0.0), sweepAngle: Angle<Double>(radians: 1.1486965280692114)), startPeriod: 0.0, endPeriod: 0.16940254725353476)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: -25.0, y: 30.0), radius: 90.0, startAngle: Angle<Double>(radians: 0.7481123144455527), sweepAngle: Angle<Double>(radians: 0.822684012349344)), startPeriod: 0.16940254725353476, endPeriod: 0.2785943899066069)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: -25.0, y: 30.0), radius: 90.0, startAngle: Angle<Double>(radians: 1.5707963267948966), sweepAngle: Angle<Double>(radians: 1.5707963267948966)), startPeriod: 0.2785943899066069, endPeriod: 0.4870804462547868)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: -25.0, y: 30.0), radius: 90.0, startAngle: Angle<Double>(radians: 3.141592653589793), sweepAngle: Angle<Double>(radians: 0.6413642379478535)), startPeriod: 0.4870804462547868, endPeriod: 0.5722063778422009)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: 0.0, y: 0.0), radius: 100.0, startAngle: Angle<Double>(radians: 3.3823726779139887), sweepAngle: Angle<Double>(radians: 1.330016302470701)), startPeriod: 0.5722063778422009, endPeriod: 0.7683488262798001)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: 0.0, y: 0.0), radius: 100.0, startAngle: Angle<Double>(radians: 4.71238898038469), sweepAngle: Angle<Double>(radians: 1.5707963267948966)), startPeriod: 0.7683488262798001, endPeriod: 1.0))], [GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: 0.0, y: 0.0), radius: 80.0, startAngle: Angle<Double>(radians: 6.283185307179586), sweepAngle: Angle<Double>(radians: -1.5707963267948966)), startPeriod: 0.0, endPeriod: 0.28315827740519056)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: 0.0, y: 0.0), radius: 80.0, startAngle: Angle<Double>(radians: 4.71238898038469), sweepAngle: Angle<Double>(radians: -0.8480463199895979)), startPeriod: 0.28315827740519056, endPeriod: 0.43603063331274305)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: -25.0, y: 30.0), radius: 90.0, startAngle: Angle<Double>(radians: 4.3129737976338784), sweepAngle: Angle<Double>(radians: 0.3994151827508115)), startPeriod: 0.43603063331274305, endPeriod: 0.5170309051725986)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: -25.0, y: 30.0), radius: 90.0, startAngle: Angle<Double>(radians: 4.71238898038469), sweepAngle: Angle<Double>(radians: 1.5707963267948966)), startPeriod: 0.5170309051725986, endPeriod: 0.8355839672534379)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: -25.0, y: 30.0), radius: 90.0, startAngle: Angle<Double>(radians: 0.0), sweepAngle: Angle<Double>(radians: 0.21809540834932087)), startPeriod: 0.8355839672534379, endPeriod: 0.8798131005728456)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: 0.0, y: 0.0), radius: 80.0, startAngle: Angle<Double>(radians: 0.6667265455881081), sweepAngle: Angle<Double>(radians: -0.6667265455881081)), startPeriod: 0.8798131005728456, endPeriod: 1.0))]]
                )
        }
    }

    func testUnion_interference_containment_edge_sameDirection() {
        // >-----
        // |      ---
        // |  1   v 2 |
        // |      ---
        // ------
        let lhs = LinePolygon2Parametric.makeRectangle(width: 200, height: 200, center: .zero)
        let rhs = LinePolygon2Parametric
            .makeRectangle(width: 100, height: 100, center: .init(x: 150, y: 0))
            .reversed()
        let sut = Union2Parametric(lhs, rhs, tolerance: accuracy)

        TestFixture.beginFixture { fixture in
            fixture.assertions(on: sut)
                .assertAllSimplexes(
                    accuracy: accuracy,
                    [[GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: -100.0, y: -100.0), end: Vector2<Double>(x: 100.0, y: -100.0)), startPeriod: 0.0, endPeriod: 0.25)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: 100.0, y: -100.0), end: Vector2<Double>(x: 100.0, y: -50.0)), startPeriod: 0.25, endPeriod: 0.3125)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: 100.0, y: -50.0), end: Vector2<Double>(x: 100.0, y: 50.0)), startPeriod: 0.3125, endPeriod: 0.4375)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: 100.0, y: 50.0), end: Vector2<Double>(x: 100.0, y: 100.0)), startPeriod: 0.4375, endPeriod: 0.5)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: 100.0, y: 100.0), end: Vector2<Double>(x: -100.0, y: 100.0)), startPeriod: 0.5, endPeriod: 0.75)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: -100.0, y: 100.0), end: Vector2<Double>(x: -100.0, y: -100.0)), startPeriod: 0.75, endPeriod: 1.0))]]
                )
        }
    }

    func testUnion_interference_containment_edge_opposing() {
        // >-----
        // |      >--
        // |  1   | 2 |
        // |      ---
        // ------
        let lhs = LinePolygon2Parametric.makeRectangle(width: 200, height: 200, center: .zero)
        let rhs = LinePolygon2Parametric.makeRectangle(width: 100, height: 100, center: .init(x: 150, y: 0))
        let sut = Union2Parametric(lhs, rhs, tolerance: accuracy)

        TestFixture.beginFixture { fixture in
            fixture.assertions(on: sut)
                .assertAllSimplexes(
                    accuracy: accuracy,
                    [[GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: -100.0, y: -100.0), end: Vector2<Double>(x: 100.0, y: -100.0)), startPeriod: 0.0, endPeriod: 0.2)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: 100.0, y: -100.0), end: Vector2<Double>(x: 100.0, y: -50.0)), startPeriod: 0.2, endPeriod: 0.25)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: 100.0, y: -50.0), end: Vector2<Double>(x: 200.0, y: -50.0)), startPeriod: 0.25, endPeriod: 0.35)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: 200.0, y: -50.0), end: Vector2<Double>(x: 200.0, y: 50.0)), startPeriod: 0.35, endPeriod: 0.45)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: 200.0, y: 50.0), end: Vector2<Double>(x: 100.0, y: 50.0)), startPeriod: 0.45, endPeriod: 0.55)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: 100.0, y: 50.0), end: Vector2<Double>(x: 100.0, y: 100.0)), startPeriod: 0.55, endPeriod: 0.6)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: 100.0, y: 100.0), end: Vector2<Double>(x: -100.0, y: 100.0)), startPeriod: 0.6, endPeriod: 0.8)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: -100.0, y: 100.0), end: Vector2<Double>(x: -100.0, y: -100.0)), startPeriod: 0.8, endPeriod: 1.0))]]
                )
        }
    }

    func testUnion_interference_containment_edge_opposing_multiple() {
        // >-----
        // |      >--
        // |  1   | 2 |
        // |      ---
        // |      |
        // |      >--
        // |      | 2 |
        // |      ---
        // ------
        let lhs = LinePolygon2Parametric.makeRectangle(width: 200, height: 500, center: .zero)
        let rhs1 = LinePolygon2Parametric.makeRectangle(width: 100, height: 100, center: .init(x: 150, y: -150))
        let rhs2 = LinePolygon2Parametric.makeRectangle(width: 100, height: 100, center: .init(x: 150, y: 150))
        let rhs = Union2Parametric.union(rhs1, rhs2)
        let sut = Union2Parametric(lhs, rhs, tolerance: accuracy)

        TestFixture.beginFixture { fixture in
            fixture.add(lhs, category: "input")
            fixture.add(rhs1, category: "input")
            fixture.add(rhs2, category: "input")
            fixture.assertions(on: sut)
                .assertAllSimplexes(
                    accuracy: accuracy,
                    [[GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: -100.0, y: -250.0), end: Vector2<Double>(x: 100.0, y: -250.0)), startPeriod: 0.0, endPeriod: 0.1111111111111111)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: 100.0, y: -250.0), end: Vector2<Double>(x: 100.0, y: -200.0)), startPeriod: 0.1111111111111111, endPeriod: 0.1388888888888889)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: 100.0, y: -200.0), end: Vector2<Double>(x: 200.0, y: -200.0)), startPeriod: 0.1388888888888889, endPeriod: 0.19444444444444445)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: 200.0, y: -200.0), end: Vector2<Double>(x: 200.0, y: -100.0)), startPeriod: 0.19444444444444445, endPeriod: 0.25)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: 200.0, y: -100.0), end: Vector2<Double>(x: 100.0, y: -100.0)), startPeriod: 0.25, endPeriod: 0.3055555555555556)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: 100.0, y: -100.0), end: Vector2<Double>(x: 100.0, y: 100.00000000000001)), startPeriod: 0.3055555555555556, endPeriod: 0.4166666666666667)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: 100.0, y: 100.00000000000001), end: Vector2<Double>(x: 200.0, y: 100.0)), startPeriod: 0.4166666666666667, endPeriod: 0.4722222222222222)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: 200.0, y: 100.0), end: Vector2<Double>(x: 200.0, y: 200.0)), startPeriod: 0.4722222222222222, endPeriod: 0.5277777777777778)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: 200.0, y: 200.0), end: Vector2<Double>(x: 100.0, y: 200.0)), startPeriod: 0.5277777777777778, endPeriod: 0.5833333333333334)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: 100.0, y: 200.0), end: Vector2<Double>(x: 100.0, y: 250.0)), startPeriod: 0.5833333333333334, endPeriod: 0.6111111111111112)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: 100.0, y: 250.0), end: Vector2<Double>(x: -100.0, y: 250.0)), startPeriod: 0.6111111111111112, endPeriod: 0.7222222222222222)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: -100.0, y: 250.0), end: Vector2<Double>(x: -100.0, y: -250.0)), startPeriod: 0.7222222222222222, endPeriod: 1.0))]]
                )
        }
    }

    func testUnion_interference_total() {
        let lhs = Circle2Parametric.makeTestCircle()
        let rhs = Circle2Parametric.makeTestCircle()
        let sut = Union2Parametric(lhs, rhs, tolerance: accuracy)

        TestFixture.beginFixture { fixture in
            fixture.assertions(on: sut)
                .assertAllSimplexes(
                    accuracy: accuracy,
                    [[GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: 0.0, y: 0.0), radius: 100.0, startAngle: Angle<Double>(radians: 3.141592653589793), sweepAngle: Angle<Double>(radians: 1.5707963267948966)), startPeriod: 0.0, endPeriod: 0.25)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: 0.0, y: 0.0), radius: 100.0, startAngle: Angle<Double>(radians: 4.71238898038469), sweepAngle: Angle<Double>(radians: 1.5707963267948966)), startPeriod: 0.25, endPeriod: 0.5)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: 0.0, y: 0.0), radius: 100.0, startAngle: Angle<Double>(radians: 0.0), sweepAngle: Angle<Double>(radians: 1.5707963267948966)), startPeriod: 0.5, endPeriod: 0.75)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: 0.0, y: 0.0), radius: 100.0, startAngle: Angle<Double>(radians: 1.5707963267948966), sweepAngle: Angle<Double>(radians: 1.5707963267948966)), startPeriod: 0.75, endPeriod: 1.0))]]
                )
        }
    }

    #if GEOMETRIA_PERFORMANCE_TESTS

    func testPerformance_overlapping_circles() {
        let inputs = (0...10).map { offset in
            return Circle2Parametric.makeTestCircle(center: .init(x: Double(offset), y: 0.0), radius: 10.0)
        }

        measure {
            _ = union(inputs)
        }
    }

    #endif // #if GEOMETRIA_PERFORMANCE_TESTS
}
