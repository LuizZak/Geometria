import Geometria
import TestCommons
import XCTest

@testable import GeometriaClipping

class Union2ParametricTests: XCTestCase {
    let accuracy: Double = 1e-12

    func testUnion_vennDiagram() {
        let lhs = Circle2Parametric.makeTestCircle(center: .init(x: -90, y: 0), radius: 200)
        let rhs = Circle2Parametric.makeTestCircle(center: .init(x:  90, y: 0), radius: 200)
        let sut = Union2Parametric(lhs, rhs, tolerance: accuracy)

        TestFixture.beginFixture(lineScale: 1.0) { fixture in
            fixture.add(lhs, category: "input 1")
            fixture.add(rhs, category: "input 2")

            fixture.assertions(on: sut)
                .assertAllSimplexes(
                    accuracy: accuracy,
                    [[GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: -90.0, y: 0.0), radius: 200.0, startAngle: Angle<Double>(radians: 1.1040309877476002), sweepAngle: Angle<Double>(radians: 0.4667653390472963)), startPeriod: 0.0, endPeriod: 0.05727008743737412)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: -90.0, y: 0.0), radius: 200.0, startAngle: Angle<Double>(radians: 1.5707963267948966), sweepAngle: Angle<Double>(radians: 1.5707963267948966)), startPeriod: 0.05727008743737412, endPeriod: 0.24999999999999997)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: -90.0, y: 0.0), radius: 200.0, startAngle: Angle<Double>(radians: 3.141592653589793), sweepAngle: Angle<Double>(radians: 1.5707963267948966)), startPeriod: 0.24999999999999997, endPeriod: 0.4427299125626258)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: -90.0, y: 0.0), radius: 200.0, startAngle: Angle<Double>(radians: 4.71238898038469), sweepAngle: Angle<Double>(radians: 0.46676533904729645)), startPeriod: 0.4427299125626258, endPeriod: 0.49999999999999994)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: 90.0, y: 0.0), radius: 200.0, startAngle: Angle<Double>(radians: 4.245623641337393), sweepAngle: Angle<Double>(radians: 0.46676533904729645)), startPeriod: 0.49999999999999994, endPeriod: 0.557270087437374)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: 90.0, y: 0.0), radius: 200.0, startAngle: Angle<Double>(radians: 4.71238898038469), sweepAngle: Angle<Double>(radians: 1.5707963267948966)), startPeriod: 0.557270087437374, endPeriod: 0.7499999999999999)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: 90.0, y: 0.0), radius: 200.0, startAngle: Angle<Double>(radians: 0.0), sweepAngle: Angle<Double>(radians: 1.5707963267948966)), startPeriod: 0.7499999999999999, endPeriod: 0.9427299125626258)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: 90.0, y: 0.0), radius: 200.0, startAngle: Angle<Double>(radians: 1.5707963267948966), sweepAngle: Angle<Double>(radians: 0.46676533904729645)), startPeriod: 0.9427299125626258, endPeriod: 1.0))]]
                )
        }
    }

    func testUnion_emptyContours() {
        let contour1 = Parametric2Contour<Vector2D>(simplexes: [])
        let contour2 = Parametric2Contour<Vector2D>(simplexes: [])
        let sut = Union2Parametric(contours: [contour1, contour2], tolerance: accuracy)


        TestFixture.beginFixture(lineScale: 1.0) { fixture in
            fixture.assertions(on: sut)
                .assertAllSimplexes(
                    accuracy: accuracy,
                    []
                )
        }
    }

    func testUnion_lhsContainsRhs() {
        let lhs = Circle2Parametric.makeTestCircle(radius: 100.0)
        let rhs = Circle2Parametric.makeTestCircle(radius: 80.0)
        let sut = Union2Parametric(lhs, rhs, tolerance: accuracy)

        TestFixture.beginFixture { fixture in
            fixture.assertions(on: sut)
                .assertAllSimplexes(
                    accuracy: accuracy,
                    [lhs.allSimplexes()]
                )
        }
    }

    func testUnion_rhsContainsLhs() {
        let lhs = Circle2Parametric.makeTestCircle(radius: 80.0)
        let rhs = Circle2Parametric.makeTestCircle(radius: 100.0)
        let sut = Union2Parametric(lhs, rhs, tolerance: accuracy)

        TestFixture.beginFixture { fixture in
            fixture.assertions(on: sut)
                .assertAllSimplexes(
                    accuracy: accuracy,
                    [rhs.allSimplexes()]
                )
        }
    }

    func testUnion_noIntersectionOrContainment() {
        let lhs = Circle2Parametric.makeTestCircle(center: .init(x: -100, y: 0), radius: 50.0)
        let rhs = Circle2Parametric.makeTestCircle(center: .init(x: 100, y: 0), radius: 50.0)
        let sut = Union2Parametric(lhs, rhs, tolerance: accuracy)

        TestFixture.beginFixture { fixture in
            fixture.assertions(on: sut)
                .assertAllSimplexes(
                    accuracy: accuracy,
                    [lhs.allSimplexes(), rhs.allSimplexes()]
                )
        }
    }

    func testUnion_lines_lines() {
        let lhs = LinePolygon2Parametric.makeStar()
        let rhs = LinePolygon2Parametric.makeHexagon(radius: 80.0)
        let sut = Union2Parametric(lhs, rhs, tolerance: accuracy)

        TestFixture.beginFixture(renderScale: 2.0) { fixture in
            fixture.assertions(on: sut)
                .assertAllSimplexes(
                    accuracy: accuracy,
                    [[GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: 100.0, y: 0.0), end: Vector2<Double>(x: 74.9785189589521, y: 8.697460292338837)), startPeriod: 0.0, endPeriod: 0.0392255056302415)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: 74.9785189589521, y: 8.697460292338837), end: Vector2<Double>(x: 40.00000000000001, y: 69.28203230275508)), startPeriod: 0.0392255056302415, endPeriod: 0.14281552967403852)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: 40.00000000000001, y: 69.28203230275508), end: Vector2<Double>(x: 31.42794501299971, y: 69.28203230275507)), startPeriod: 0.14281552967403852, endPeriod: 0.15550873980180535)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: 31.42794501299971, y: 69.28203230275507), end: Vector2<Double>(x: 30.901699437494745, y: 95.10565162951535)), startPeriod: 0.15550873980180535, endPeriod: 0.1937554240880302)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: 30.901699437494745, y: 95.10565162951535), end: Vector2<Double>(x: 11.323626827162714, y: 69.28203230275508)), startPeriod: 0.1937554240880302, endPeriod: 0.24174139733448927)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: 11.323626827162714, y: 69.28203230275508), end: Vector2<Double>(x: -39.999999999999986, y: 69.2820323027551)), startPeriod: 0.24174139733448927, endPeriod: 0.3177396942217845)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: -39.999999999999986, y: 69.2820323027551), end: Vector2<Double>(x: -51.244447041333736, y: 49.80607872414753)), startPeriod: 0.3177396942217845, endPeriod: 0.3510404906545292)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: -51.244447041333736, y: 49.80607872414753), end: Vector2<Double>(x: -80.90169943749473, y: 58.77852522924732)), startPeriod: 0.3510404906545292, endPeriod: 0.39692172832110456)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: -80.90169943749473, y: 58.77852522924732), end: Vector2<Double>(x: -61.86160744855665, y: 31.41661746672879)), startPeriod: 0.39692172832110456, endPeriod: 0.4462825592265689)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: -61.86160744855665, y: 31.41661746672879), end: Vector2<Double>(x: -80.0, y: 9.797174393178826e-15)), startPeriod: 0.4462825592265689, endPeriod: 0.5)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: -80.0, y: 9.797174393178826e-15), end: Vector2<Double>(x: -61.86160744855664, y: -31.416617466728745)), startPeriod: 0.5, endPeriod: 0.5537174407734311)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: -61.86160744855664, y: -31.416617466728745), end: Vector2<Double>(x: -80.90169943749476, y: -58.7785252292473)), startPeriod: 0.5537174407734311, endPeriod: 0.6030782716788955)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: -80.90169943749476, y: -58.7785252292473), end: Vector2<Double>(x: -51.24444704133376, y: -49.80607872414752)), startPeriod: 0.6030782716788955, endPeriod: 0.648959509345471)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: -51.24444704133376, y: -49.80607872414752), end: Vector2<Double>(x: -40.000000000000036, y: -69.28203230275507)), startPeriod: 0.648959509345471, endPeriod: 0.6822603057782156)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: -40.000000000000036, y: -69.28203230275507), end: Vector2<Double>(x: 11.323626827162698, y: -69.28203230275508)), startPeriod: 0.6822603057782156, endPeriod: 0.7582586026655108)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: 11.323626827162698, y: -69.28203230275508), end: Vector2<Double>(x: 30.901699437494724, y: -95.10565162951536)), startPeriod: 0.7582586026655108, endPeriod: 0.8062445759119699)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: 30.901699437494724, y: -95.10565162951536), end: Vector2<Double>(x: 31.427945012999693, y: -69.28203230275513)), startPeriod: 0.8062445759119699, endPeriod: 0.8444912601981946)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: 31.427945012999693, y: -69.28203230275513), end: Vector2<Double>(x: 40.00000000000001, y: -69.28203230275508)), startPeriod: 0.8444912601981946, endPeriod: 0.8571844703259616)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: 40.00000000000001, y: -69.28203230275508), end: Vector2<Double>(x: 74.97851895895208, y: -8.697460292338846)), startPeriod: 0.8571844703259616, endPeriod: 0.9607744943697585)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: 74.97851895895208, y: -8.697460292338846), end: Vector2<Double>(x: 100.0, y: 0.0)), startPeriod: 0.9607744943697585, endPeriod: 1.0))]]
                )
        }
    }

    func testUnion_lines_arcs() {
        let lhs = LinePolygon2Parametric.makeHexagon()
        let rhs = Circle2Parametric.makeTestCircle(radius: 95)

        let sut = Union2Parametric(lhs, rhs, tolerance: accuracy)

        TestFixture.beginFixture(renderScale: 2.0) { fixture in
            fixture.assertions(on: sut)
                .assertAllSimplexes(
                    accuracy: accuracy,
                    [[GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: 100.0, y: 0.0), end: Vector2<Double>(x: 94.52562418976665, y: 9.481897043050221)), startPeriod: 0.0, endPeriod: 0.017822696814540084)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: 0.0, y: 0.0), radius: 95.0, startAngle: Angle<Double>(radians: 0.09997590556877552), sweepAngle: Angle<Double>(radians: 0.8472457400590464)), startPeriod: 0.017822696814540084, endPeriod: 0.14884396985212653)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: 55.47437581023338, y: 77.12064333539362), end: Vector2<Double>(x: 50.000000000000014, y: 86.60254037844386)), startPeriod: 0.14884396985212653, endPeriod: 0.16666666666666663)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: 50.000000000000014, y: 86.60254037844386), end: Vector2<Double>(x: 39.051248379533256, y: 86.60254037844386)), startPeriod: 0.16666666666666663, endPeriod: 0.1844893634812068)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: 0.0, y: 0.0), radius: 95.0, startAngle: Angle<Double>(radians: 1.1471734567653735), sweepAngle: Angle<Double>(radians: 0.8472457400590461)), startPeriod: 0.1844893634812068, endPeriod: 0.31551063651879313)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: -39.05124837953323, y: 86.60254037844388), end: Vector2<Double>(x: -49.99999999999998, y: 86.60254037844388)), startPeriod: 0.31551063651879313, endPeriod: 0.33333333333333326)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: -49.99999999999998, y: 86.60254037844388), end: Vector2<Double>(x: -55.47437581023333, y: 77.12064333539367)), startPeriod: 0.33333333333333326, endPeriod: 0.35115603014787333)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: 0.0, y: 0.0), radius: 95.0, startAngle: Angle<Double>(radians: 2.194371007961971), sweepAngle: Angle<Double>(radians: 0.8472457400590464)), startPeriod: 0.35115603014787333, endPeriod: 0.4821773031854597)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: -94.52562418976665, y: 9.481897043050228), end: Vector2<Double>(x: -100.0, y: 1.2246467991473532e-14)), startPeriod: 0.4821773031854597, endPeriod: 0.49999999999999983)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: -100.0, y: 1.2246467991473532e-14), end: Vector2<Double>(x: -94.52562418976665, y: -9.481897043050205)), startPeriod: 0.49999999999999983, endPeriod: 0.51782269681454)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: 0.0, y: 0.0), radius: 95.0, startAngle: Angle<Double>(radians: 3.241568559158569), sweepAngle: Angle<Double>(radians: 0.8472457400590453)), startPeriod: 0.51782269681454, endPeriod: 0.6488439698521262)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: -55.4743758102334, y: -77.12064333539361), end: Vector2<Double>(x: -50.00000000000004, y: -86.60254037844383)), startPeriod: 0.6488439698521262, endPeriod: 0.6666666666666663)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: -50.00000000000004, y: -86.60254037844383), end: Vector2<Double>(x: -39.051248379533334, y: -86.60254037844383)), startPeriod: 0.6666666666666663, endPeriod: 0.6844893634812064)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: 0.0, y: 0.0), radius: 95.0, startAngle: Angle<Double>(radians: 4.288766110355166), sweepAngle: Angle<Double>(radians: 0.8472457400590481)), startPeriod: 0.6844893634812064, endPeriod: 0.8155106365187931)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: 39.05124837953331, y: -86.60254037844386), end: Vector2<Double>(x: 50.000000000000014, y: -86.60254037844386)), startPeriod: 0.8155106365187931, endPeriod: 0.8333333333333331)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: 50.000000000000014, y: -86.60254037844386), end: Vector2<Double>(x: 55.47437581023337, y: -77.12064333539365)), startPeriod: 0.8333333333333331, endPeriod: 0.8511560301478732)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: 0.0, y: 0.0), radius: 95.0, startAngle: Angle<Double>(radians: 5.335963661551764), sweepAngle: Angle<Double>(radians: 0.8472457400590474)), startPeriod: 0.8511560301478732, endPeriod: 0.9821773031854599)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: 94.52562418976665, y: -9.481897043050214), end: Vector2<Double>(x: 100.0, y: 0.0)), startPeriod: 0.9821773031854599, endPeriod: 1.0))]]
                )
        }
    }

    func testUnion_arcsArcs() {
        let lhs = Circle2Parametric.makeTestCircle(center: .init(x: -25.0, y: 5.0), radius: 115)
        let rhs = Circle2Parametric.makeTestCircle(center: .init(x: 25.0, y: -5.0), radius: 85)

        let sut = Union2Parametric(lhs, rhs, tolerance: 1e-14)

        TestFixture.beginFixture { fixture in
            fixture.assertions(on: sut)
                .assertAllSimplexes(
                    accuracy: accuracy,
                    [[GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: -25.0, y: 5.0), radius: 115.0, startAngle: Angle<Double>(radians: 0.5502322143364249), sweepAngle: Angle<Double>(radians: 1.0205641124584717)), startPeriod: 0.0, endPeriod: 0.1566687353278738)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: -25.0, y: 5.0), radius: 115.0, startAngle: Angle<Double>(radians: 1.5707963267948966), sweepAngle: Angle<Double>(radians: 1.5707963267948966)), startPeriod: 0.1566687353278738, endPeriod: 0.39780466297067535)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: -25.0, y: 5.0), radius: 115.0, startAngle: Angle<Double>(radians: 3.141592653589793), sweepAngle: Angle<Double>(radians: 1.5707963267948966)), startPeriod: 0.39780466297067535, endPeriod: 0.6389405906134769)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: -25.0, y: 5.0), radius: 115.0, startAngle: Angle<Double>(radians: 4.71238898038469), sweepAngle: Angle<Double>(radians: 0.6257729927587105)), startPeriod: 0.6389405906134769, endPeriod: 0.7350041913035661)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: 25.0, y: -5.0), radius: 85.0, startAngle: Angle<Double>(radians: 4.918050495000922), sweepAngle: Angle<Double>(radians: 1.3651348121786642)), startPeriod: 0.7350041913035661, endPeriod: 0.8898996454092252)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: 25.0, y: -5.0), radius: 85.0, startAngle: Angle<Double>(radians: 0.0), sweepAngle: Angle<Double>(radians: 0.9703436924789027)), startPeriod: 0.8898996454092252, endPeriod: 1.0))]]
                )
        }
    }

    func testUnion_concaveShape() {
        let lhs = LinePolygon2Parametric.makeCShape()
        let rhs = LinePolygon2Parametric.makeRectangle(width: 10, height: 120)
        let sut = Union2Parametric(lhs, rhs, tolerance: accuracy)

        TestFixture.beginFixture(renderScale: 2) { fixture in
            fixture.assertions(on: sut)
                .assertAllSimplexes(
                    accuracy: accuracy,
                    [[GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: -50.0, y: -50.0), end: Vector2<Double>(x: -4.999999999999999, y: -50.0)), startPeriod: 0.0, endPeriod: 0.08883299341559671)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: -4.999999999999999, y: -50.0), end: Vector2<Double>(x: -5.0, y: -60.0)), startPeriod: 0.08883299341559671, endPeriod: 0.10857365861906265)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: -5.0, y: -60.0), end: Vector2<Double>(x: 5.0, y: -60.0)), startPeriod: 0.10857365861906265, endPeriod: 0.12831432382252858)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: 5.0, y: -60.0), end: Vector2<Double>(x: 5.000000000000005, y: -50.0)), startPeriod: 0.12831432382252858, endPeriod: 0.1480549890259945)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: 5.000000000000005, y: -50.0), end: Vector2<Double>(x: 50.0, y: -50.0)), startPeriod: 0.1480549890259945, endPeriod: 0.23688798244159123)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: 50.0, y: -50.0), end: Vector2<Double>(x: 30.0, y: -30.0)), startPeriod: 0.23688798244159123, endPeriod: 0.29272301536360756)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: 30.0, y: -30.0), end: Vector2<Double>(x: 4.999999999999982, y: -30.0)), startPeriod: 0.29272301536360756, endPeriod: 0.34207467837227246)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: 4.999999999999982, y: -30.0), end: Vector2<Double>(x: 4.999999999999993, y: 30.0)), startPeriod: 0.34207467837227246, endPeriod: 0.4605186695930681)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: 4.999999999999993, y: 30.0), end: Vector2<Double>(x: 30.0, y: 30.0)), startPeriod: 0.4605186695930681, endPeriod: 0.509870332601733)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: 30.0, y: 30.0), end: Vector2<Double>(x: 50.0, y: 50.0)), startPeriod: 0.509870332601733, endPeriod: 0.5657053655237493)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: 50.0, y: 50.0), end: Vector2<Double>(x: 4.999999999999977,y: 50.0)), startPeriod: 0.5657053655237493, endPeriod: 0.654538358939346)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: 4.999999999999977, y: 50.0), end: Vector2<Double>(x: 5.0, y: 60.0)), startPeriod: 0.654538358939346, endPeriod: 0.6742790241428119)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: 5.0, y: 60.0), end: Vector2<Double>(x: -5.0, y: 60.0)), startPeriod: 0.6742790241428119, endPeriod: 0.6940196893462779)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: -5.0, y: 60.0), end: Vector2<Double>(x: -4.999999999999975, y: 50.0)), startPeriod: 0.6940196893462779, endPeriod: 0.7137603545497438)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: -4.999999999999975, y: 50.0), end: Vector2<Double>(x: -50.0, y: 50.0)), startPeriod: 0.7137603545497438, endPeriod: 0.8025933479653407)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: -50.0, y: 50.0), end: Vector2<Double>(x: -50.0, y: -50.0)), startPeriod: 0.8025933479653407, endPeriod: 1.0))], [GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: -5.000000000000002, y: -30.0), end: Vector2<Double>(x: -30.0, y: -30.0)), startPeriod: 0.0, endPeriod: 0.1470588235294118)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: -30.0, y: -30.0), end: Vector2<Double>(x: -30.0, y: 30.0)), startPeriod: 0.1470588235294118, endPeriod: 0.5000000000000001)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: -30.0, y: 30.0), end: Vector2<Double>(x: -5.000000000000022, y: 30.0)), startPeriod: 0.5000000000000001, endPeriod: 0.6470588235294117)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: -5.000000000000022, y: 30.0), end: Vector2<Double>(x: -5.000000000000002, y: -30.0)), startPeriod: 0.6470588235294117, endPeriod: 1.0))]]
                )
        }
    }

    func testUnion_intersectionOnStartPeriod() {
        let lhs = Circle2Parametric.makeTestCircle()
        let rhs = LinePolygon2Parametric.makeRectangle(
            width: 220,
            height: 220,
            center: .init(x: 0.0, y: -110.0)
        )
        let sut = Union2Parametric(lhs, rhs, tolerance: accuracy)

        TestFixture.beginFixture(renderScale: 2) { fixture in
            fixture.assertions(on: sut)
                .assertAllSimplexes(
                    accuracy: accuracy,
                    [[GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: 0.0, y: 0.0), radius: 100.0, startAngle: Angle<Double>(radians: 0.0), sweepAngle: Angle<Double>(radians: 1.5707963267948966)), startPeriod: 0.0, endPeriod: 0.158002483256815)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: 0.0, y: 0.0), radius: 100.0, startAngle: Angle<Double>(radians: 1.5707963267948966), sweepAngle: Angle<Double>(radians: 1.5707963267948966)), startPeriod: 0.158002483256815, endPeriod: 0.31600496651363)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: -100.0, y: 1.2246467991473532e-14), end: Vector2<Double>(x: -110.0, y: 0.0)), startPeriod: 0.31600496651363, endPeriod: 0.32606371700607667)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: -110.0, y: 0.0), end: Vector2<Double>(x: -110.0, y: -220.0)), startPeriod: 0.32606371700607667, endPeriod: 0.5473562278399022)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: -110.0, y: -220.0), end: Vector2<Double>(x: 110.0, y: -220.0)), startPeriod: 0.5473562278399022, endPeriod: 0.7686487386737278)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: 110.0, y: -220.0), end: Vector2<Double>(x: 110.0, y: 0.0)), startPeriod: 0.7686487386737278, endPeriod: 0.9899412495075534)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: 110.0, y: 0.0), end: Vector2<Double>(x: 100.0, y: 0.0)), startPeriod: 0.9899412495075534, endPeriod: 1.0))]]
                )
        }
    }

    func testUnion_intersectionOnStartPeriod_2() {
        let lhs = Circle2Parametric.makeTestCircle()
        let rhs = LinePolygon2Parametric.makeRectangle(
            width: 220,
            height: 220,
            center: .init(x: 0.0, y: 110.0)
        )
        let sut = Union2Parametric(lhs, rhs, tolerance: accuracy)

        TestFixture.beginFixture(renderScale: 2) { fixture in
            fixture.assertions(on: sut)
                .assertAllSimplexes(
                    accuracy: accuracy,
                    [[GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: 0.0, y: 0.0), radius: 100.0, startAngle: Angle<Double>(radians: 3.141592653589793), sweepAngle: Angle<Double>(radians: 1.5707963267948966)), startPeriod: 0.0, endPeriod: 0.158002483256815)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: 0.0, y: 0.0), radius: 100.0, startAngle: Angle<Double>(radians: 4.71238898038469), sweepAngle: Angle<Double>(radians: 1.5707963267948966)), startPeriod: 0.158002483256815, endPeriod: 0.31600496651363)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: 100.0, y: 0.0), end: Vector2<Double>(x: 110.0, y: 0.0)), startPeriod: 0.31600496651363, endPeriod: 0.32606371700607667)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: 110.0, y: 0.0), end: Vector2<Double>(x: 110.0, y: 220.0)), startPeriod: 0.32606371700607667, endPeriod: 0.5473562278399022)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: 110.0, y: 220.0), end: Vector2<Double>(x: -110.0, y: 220.0)), startPeriod: 0.5473562278399022, endPeriod: 0.7686487386737278)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: -110.0, y: 220.0), end: Vector2<Double>(x: -110.0, y: 0.0)), startPeriod: 0.7686487386737278, endPeriod: 0.9899412495075534)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: -110.0, y: 0.0), end: Vector2<Double>(x: -100.0, y: 1.2246467991473532e-14)), startPeriod: 0.9899412495075534, endPeriod: 1.0))]]
                )
        }
    }

    func testUnion_intersectionOnStartPeriod_3() {
        let lhs = Circle2Parametric.makeTestCircle()
        let rhs = LinePolygon2Parametric.makeRectangle(
            width: 220,
            height: 50,
            center: .init(x: 0.0, y: -25.0)
        ).reversed()
        let sut = Union2Parametric(lhs, rhs, tolerance: accuracy)

        TestFixture.beginFixture(renderScale: 2) { fixture in
            fixture.assertions(on: sut)
                .assertAllSimplexes(
                    accuracy: accuracy,
                    [[GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: 0.0, y: 0.0), radius: 100.0, startAngle: Angle<Double>(radians: 0.0), sweepAngle: Angle<Double>(radians: 1.5707963267948966)), startPeriod: 0.0, endPeriod: 0.30550773517582863)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: 0.0, y: 0.0), radius: 100.0, startAngle: Angle<Double>(radians: 1.5707963267948966), sweepAngle: Angle<Double>(radians: 1.5707963267948966)), startPeriod: 0.30550773517582863, endPeriod: 0.6110154703516573)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: -100.0, y: 1.2246467991473532e-14), end: Vector2<Double>(x: 100.0, y: 0.0)), startPeriod: 0.6110154703516573, endPeriod: 1.0))], [GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: 0.0, y: 0.0), radius: 100.0, startAngle: Angle<Double>(radians: 3.6651914291880914), sweepAngle: Angle<Double>(radians: 1.047197551196598)), startPeriod: 0.0, endPeriod: 0.273673684624743)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: 0.0, y: 0.0), radius: 100.0, startAngle: Angle<Double>(radians: 4.71238898038469), sweepAngle: Angle<Double>(radians: 1.0471975511965974)), startPeriod: 0.273673684624743, endPeriod: 0.5473473692494858)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: 86.60254037844383, y: -50.00000000000004), end: Vector2<Double>(x: -86.6025403784439, y: -49.999999999999936)), startPeriod: 0.5473473692494858, endPeriod: 1.0))]]
                )
        }
    }

    func testUnion_rhsOccludesLhsHole() {
        let radius: Double = 50.0
        let circles = [
            Circle2Parametric.makeTestCircle(center: .init(x: 0, y: 55), radius: radius),
            Circle2Parametric.makeTestCircle(center: .init(x: -47, y: -29), radius: radius),
            Circle2Parametric.makeTestCircle(center: .init(x: 48, y: -27), radius: radius),
        ]
        let lhs = union(tolerance: accuracy, circles)
        let rhs = Circle2Parametric.makeTestCircle(center: .init(x: 0, y: 0), radius: radius)
        let sut: Union2Parametric = Union2Parametric(lhs, rhs, tolerance: accuracy)

        TestFixture.beginFixture { fixture in
            fixture.add(circles[0], category: "input 1")
            fixture.add(circles[1], category: "input 1")
            fixture.add(circles[2], category: "input 1")
            fixture.add(rhs, category: "input 2")

            fixture.assertions(on: sut)
                .assertAllSimplexes(
                    accuracy: accuracy,
                    [[GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: 0.0, y: 55.0), radius: 50.0, startAngle: Angle<Double>(radians: 0.0), sweepAngle: Angle<Double>(radians: 1.5707963267948966)), startPeriod: 0.0, endPeriod: 0.11823023429846431)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: 0.0, y: 55.0), radius: 50.0, startAngle: Angle<Double>(radians: 1.5707963267948966), sweepAngle: Angle<Double>(radians: 1.5707963267948966)), startPeriod: 0.11823023429846431, endPeriod: 0.23646046859692862)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: 0.0, y: 55.0), radius: 50.0, startAngle: Angle<Double>(radians: 3.141592653589793), sweepAngle: Angle<Double>(radians: 0.5823642378687436)), startPeriod: 0.23646046859692862, endPeriod: 0.28029368816573047)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: 0.0, y: 0.0), radius: 50.0, startAngle: Angle<Double>(radians: 2.5592284157210496), sweepAngle: Angle<Double>(radians: 0.1494914997131486)), startPeriod: 0.28029368816573047, endPeriod: 0.2915455702431337)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: -47.0, y: -29.0), radius: 50.0, startAngle: Angle<Double>(radians: 1.5385551813406735), sweepAngle: Angle<Double>(radians: 0.03224114545422309)), startPeriod: 0.2915455702431337, endPeriod: 0.2939722872630809)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: -47.0, y: -29.0), radius: 50.0, startAngle: Angle<Double>(radians: 1.5707963267948966), sweepAngle: Angle<Double>(radians: 1.5707963267948966)), startPeriod: 0.2939722872630809, endPeriod: 0.41220252156154524)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: -47.0, y: -29.0), radius: 50.0, startAngle: Angle<Double>(radians: 3.141592653589793), sweepAngle: Angle<Double>(radians: 1.5707963267948966)), startPeriod: 0.41220252156154524, endPeriod: 0.5304327558600096)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: -47.0, y: -29.0), radius: 50.0, startAngle: Angle<Double>(radians: 4.71238898038469), sweepAngle: Angle<Double>(radians: 1.1379235886393009)), startPeriod: 0.5304327558600096, endPeriod: 0.6160816526670752)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: 0.0, y: 0.0), radius: 50.0, startAngle: Angle<Double>(radians: 4.680147834930466), sweepAngle: Angle<Double>(radians: 0.1030864112323703)), startPeriod: 0.6160816526670752, endPeriod: 0.6238407302413522)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: 48.0, y: -27.0), radius: 50.0, startAngle: Angle<Double>(radians: 3.616764793985068), sweepAngle: Angle<Double>(radians: 1.095624186399622)), startPeriod: 0.6238407302413522, endPeriod: 0.7063058481254771)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: 48.0, y: -27.0), radius: 50.0, startAngle: Angle<Double>(radians: 4.71238898038469), sweepAngle: Angle<Double>(radians: 1.5707963267948966)), startPeriod: 0.7063058481254771, endPeriod: 0.8245360824239414)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: 48.0, y: -27.0), radius: 50.0, startAngle: Angle<Double>(radians: 0.0), sweepAngle: Angle<Double>(radians: 1.5707963267948966)), startPeriod: 0.8245360824239414, endPeriod: 0.9427663167224056)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: 48.0, y: -27.0), radius: 50.0, startAngle: Angle<Double>(radians: 1.5707963267948966), sweepAngle: Angle<Double>(radians: 0.07084526577814718)), startPeriod: 0.9427663167224056, endPeriod: 0.9480986772767356)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: 0.0, y: 0.0), radius: 50.0, startAngle: Angle<Double>(radians: 0.4751721403952749), sweepAngle: Angle<Double>(radians: 0.10719209747346861)), startPeriod: 0.9480986772767356, endPeriod: 0.9561667804311981)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: 0.0, y: 55.0), radius: 50.0, startAngle: Angle<Double>(radians: 5.700821069310844), sweepAngle: Angle<Double>(radians: 0.5823642378687433)), startPeriod: 0.9561667804311981, endPeriod: 1.0))]]
                )
        }
    }

    func testUnion_lhsOccludesRhsHole() {
        let lhs = Circle2Parametric.makeTestCircle(radius: 90.0)
        let rhs1 = Circle2Parametric.makeTestCircle(radius: 100.0)
        let rhs2 = Circle2Parametric.makeTestCircle(radius: 80.0)
        let rhs = Compound2Parametric(contours: Subtraction2Parametric(rhs1, rhs2).allContours())
        let sut = Union2Parametric(lhs, rhs, tolerance: accuracy)

        TestFixture.beginFixture { fixture in
            fixture.assertions(on: sut)
                .assertAllSimplexes(
                    accuracy: accuracy,
                    [[GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: 0.0, y: 0.0), radius: 100.0, startAngle: Angle<Double>(radians: 0.0), sweepAngle: Angle<Double>(radians: 1.5707963267948966)), startPeriod: 0.0, endPeriod: 0.25)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: 0.0, y: 0.0), radius: 100.0, startAngle: Angle<Double>(radians: 1.5707963267948966), sweepAngle: Angle<Double>(radians: 1.5707963267948966)), startPeriod: 0.25, endPeriod: 0.5)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: 0.0, y: 0.0), radius: 100.0, startAngle: Angle<Double>(radians: 3.141592653589793), sweepAngle: Angle<Double>(radians: 1.5707963267948966)), startPeriod: 0.5, endPeriod: 0.75)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: 0.0, y: 0.0), radius: 100.0, startAngle: Angle<Double>(radians: 4.71238898038469), sweepAngle: Angle<Double>(radians: 1.5707963267948966)), startPeriod: 0.75, endPeriod: 1.0))]]
                )
        }
    }

    func testUnion_lhsIntersectsRhsHole() {
        let lhs = Circle2Parametric.makeTestCircle(center: .init(x: -25, y: 30), radius: 90.0)
        let rhs1 = Circle2Parametric.makeTestCircle(radius: 100.0)
        let rhs2 = Circle2Parametric.makeTestCircle(radius: 80.0)
        let rhs = Compound2Parametric(contours: Subtraction2Parametric(rhs1, rhs2).allContours())
        let sut = Union2Parametric(lhs, rhs, tolerance: accuracy)

        TestFixture.beginFixture { fixture in
            fixture.assertions(on: sut)
                .assertAllSimplexes(
                    accuracy: accuracy,
                    [[GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: -25.0, y: 30.0), radius: 90.0, startAngle: Angle<Double>(radians: 0.0), sweepAngle: Angle<Double>(radians: 0.21809540834932092)), startPeriod: 0.0, endPeriod: 0.044229133319407615)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: 0.0, y: 0.0), radius: 80.0, startAngle: Angle<Double>(radians: 0.6667265455881081), sweepAngle: Angle<Double>(radians: -0.6667265455881081)), startPeriod: 0.044229133319407615, endPeriod: 0.1644160327465621)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: 0.0, y: 0.0), radius: 80.0, startAngle: Angle<Double>(radians: 6.283185307179586), sweepAngle: Angle<Double>(radians: -1.5707963267948966)), startPeriod: 0.1644160327465621, endPeriod: 0.4475743101517527)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: 0.0, y: 0.0), radius: 80.0, startAngle: Angle<Double>(radians: 4.71238898038469), sweepAngle: Angle<Double>(radians: -0.8480463199895979)), startPeriod: 0.4475743101517527, endPeriod: 0.6004466660593052)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: -25.0, y: 30.0), radius: 90.0, startAngle: Angle<Double>(radians: 4.312973797633879), sweepAngle: Angle<Double>(radians: 0.3994151827508109)), startPeriod: 0.6004466660593052, endPeriod: 0.6814469379191606)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: -25.0, y: 30.0), radius: 90.0, startAngle: Angle<Double>(radians: 4.71238898038469), sweepAngle: Angle<Double>(radians: 1.5707963267948966)), startPeriod: 0.6814469379191606, endPeriod: 1.0))], [GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: -25.0, y: 30.0), radius: 90.0, startAngle: Angle<Double>(radians: 0.7481123144455527), sweepAngle: Angle<Double>(radians: 0.822684012349344)), startPeriod: 0.0, endPeriod: 0.10919184265307214)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: -25.0, y: 30.0), radius: 90.0, startAngle: Angle<Double>(radians: 1.5707963267948966), sweepAngle: Angle<Double>(radians: 1.5707963267948966)), startPeriod: 0.10919184265307214, endPeriod: 0.317677899001252)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: -25.0, y: 30.0), radius: 90.0, startAngle: Angle<Double>(radians: 3.141592653589793), sweepAngle: Angle<Double>(radians: 0.6413642379478535)), startPeriod: 0.317677899001252, endPeriod: 0.40280383058866603)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: 0.0, y: 0.0), radius: 100.0, startAngle: Angle<Double>(radians: 3.3823726779139887), sweepAngle: Angle<Double>(radians: 1.330016302470701)), startPeriod: 0.40280383058866603, endPeriod: 0.5989462790262653)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: 0.0, y: 0.0), radius: 100.0, startAngle: Angle<Double>(radians: 4.71238898038469), sweepAngle: Angle<Double>(radians: 1.5707963267948966)), startPeriod: 0.5989462790262653, endPeriod: 0.8305974527464651)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: 0.0, y: 0.0), radius: 100.0, startAngle: Angle<Double>(radians: 0.0), sweepAngle: Angle<Double>(radians: 1.1486965280692114)), startPeriod: 0.8305974527464651, endPeriod: 1.0))]]
                )
        }
    }

    func testUnion_rhsIntersectsLhsHole() {
        let lhs1 = Circle2Parametric.makeTestCircle(radius: 100.0)
        let lhs2 = Circle2Parametric.makeTestCircle(radius: 80.0)
        let lhs = Compound2Parametric(contours: Subtraction2Parametric(lhs1, lhs2).allContours())
        let rhs = Circle2Parametric.makeTestCircle(center: .init(x: -25, y: 30), radius: 90.0)
        let sut = Union2Parametric(lhs, rhs, tolerance: accuracy)

        TestFixture.beginFixture { fixture in
            fixture.assertions(on: sut)
                .assertAllSimplexes(
                    accuracy: accuracy,
                    [[GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: 0.0, y: 0.0), radius: 100.0, startAngle: Angle<Double>(radians: 0.0), sweepAngle: Angle<Double>(radians: 1.1486965280692114)), startPeriod: 0.0, endPeriod: 0.16940254725353476)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: -25.0, y: 30.0), radius: 90.0, startAngle: Angle<Double>(radians: 0.7481123144455527), sweepAngle: Angle<Double>(radians: 0.822684012349344)), startPeriod: 0.16940254725353476, endPeriod: 0.2785943899066069)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: -25.0, y: 30.0), radius: 90.0, startAngle: Angle<Double>(radians: 1.5707963267948966), sweepAngle: Angle<Double>(radians: 1.5707963267948966)), startPeriod: 0.2785943899066069, endPeriod: 0.4870804462547868)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: -25.0, y: 30.0), radius: 90.0, startAngle: Angle<Double>(radians: 3.141592653589793), sweepAngle: Angle<Double>(radians: 0.6413642379478535)), startPeriod: 0.4870804462547868, endPeriod: 0.5722063778422009)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: 0.0, y: 0.0), radius: 100.0, startAngle: Angle<Double>(radians: 3.3823726779139887), sweepAngle: Angle<Double>(radians: 1.330016302470701)), startPeriod: 0.5722063778422009, endPeriod: 0.7683488262798001)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: 0.0, y: 0.0), radius: 100.0, startAngle: Angle<Double>(radians: 4.71238898038469), sweepAngle: Angle<Double>(radians: 1.5707963267948966)), startPeriod: 0.7683488262798001, endPeriod: 1.0))], [GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: 0.0, y: 0.0), radius: 80.0, startAngle: Angle<Double>(radians: 6.283185307179586), sweepAngle: Angle<Double>(radians: -1.5707963267948966)), startPeriod: 0.0, endPeriod: 0.28315827740519056)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: 0.0, y: 0.0), radius: 80.0, startAngle: Angle<Double>(radians: 4.71238898038469), sweepAngle: Angle<Double>(radians: -0.8480463199895979)), startPeriod: 0.28315827740519056, endPeriod: 0.43603063331274305)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: -25.0, y: 30.0), radius: 90.0, startAngle: Angle<Double>(radians: 4.3129737976338784), sweepAngle: Angle<Double>(radians: 0.3994151827508115)), startPeriod: 0.43603063331274305, endPeriod: 0.5170309051725986)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: -25.0, y: 30.0), radius: 90.0, startAngle: Angle<Double>(radians: 4.71238898038469), sweepAngle: Angle<Double>(radians: 1.5707963267948966)), startPeriod: 0.5170309051725986, endPeriod: 0.8355839672534379)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: -25.0, y: 30.0), radius: 90.0, startAngle: Angle<Double>(radians: 0.0), sweepAngle: Angle<Double>(radians: 0.21809540834932087)), startPeriod: 0.8355839672534379, endPeriod: 0.8798131005728456)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: 0.0, y: 0.0), radius: 80.0, startAngle: Angle<Double>(radians: 0.6667265455881081), sweepAngle: Angle<Double>(radians: -0.6667265455881081)), startPeriod: 0.8798131005728456, endPeriod: 1.0))]]
                )
        }
    }

    func testUnion_interference_containment_edge_sameDirection() {
        // •>-----•
        // |      •---•
        // |  1   v 2 |
        // |      •---•
        // •------•
        let lhs = LinePolygon2Parametric.makeRectangle(width: 200, height: 200, center: .zero)
        let rhs = LinePolygon2Parametric
            .makeRectangle(width: 100, height: 100, center: .init(x: 150, y: 0))
            .reversed()
        let sut = Union2Parametric(lhs, rhs, tolerance: accuracy)

        TestFixture.beginFixture { fixture in
            fixture.assertions(on: sut)
                .assertAllSimplexes(
                    accuracy: accuracy,
                    [[GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: -100.0, y: -100.0), end: Vector2<Double>(x: 100.0, y: -100.0)), startPeriod: 0.0, endPeriod: 0.25)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: 100.0, y: -100.0), end: Vector2<Double>(x: 100.0, y: -50.0)), startPeriod: 0.25, endPeriod: 0.3125)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: 100.0, y: -50.0), end: Vector2<Double>(x: 100.0, y: 50.0)), startPeriod: 0.3125, endPeriod: 0.4375)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: 100.0, y: 50.0), end: Vector2<Double>(x: 100.0, y: 100.0)), startPeriod: 0.4375, endPeriod: 0.5)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: 100.0, y: 100.0), end: Vector2<Double>(x: -100.0, y: 100.0)), startPeriod: 0.5, endPeriod: 0.75)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: -100.0, y: 100.0), end: Vector2<Double>(x: -100.0, y: -100.0)), startPeriod: 0.75, endPeriod: 1.0))]]
                )
        }
    }

    func testUnion_interference_containment_edge_opposing() {
        // •>-----•
        // |      •>--•
        // |  1   | 2 |
        // |      •---•
        // •------•
        let lhs = LinePolygon2Parametric.makeRectangle(width: 200, height: 200, center: .zero)
        let rhs = LinePolygon2Parametric.makeRectangle(width: 100, height: 100, center: .init(x: 150, y: 0))
        let sut = Union2Parametric(lhs, rhs, tolerance: accuracy)

        TestFixture.beginFixture { fixture in
            fixture.assertions(on: sut)
                .assertAllSimplexes(
                    accuracy: accuracy,
                    [[GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: -100.0, y: -100.0), end: Vector2<Double>(x: 100.0, y: -100.0)), startPeriod: 0.0, endPeriod: 0.2)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: 100.0, y: -100.0), end: Vector2<Double>(x: 100.0, y: -50.0)), startPeriod: 0.2, endPeriod: 0.25)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: 100.0, y: -50.0), end: Vector2<Double>(x: 200.0, y: -50.0)), startPeriod: 0.25, endPeriod: 0.35)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: 200.0, y: -50.0), end: Vector2<Double>(x: 200.0, y: 50.0)), startPeriod: 0.35, endPeriod: 0.45)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: 200.0, y: 50.0), end: Vector2<Double>(x: 100.0, y: 50.0)), startPeriod: 0.45, endPeriod: 0.55)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: 100.0, y: 50.0), end: Vector2<Double>(x: 100.0, y: 100.0)), startPeriod: 0.55, endPeriod: 0.6)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: 100.0, y: 100.0), end: Vector2<Double>(x: -100.0, y: 100.0)), startPeriod: 0.6, endPeriod: 0.8)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: -100.0, y: 100.0), end: Vector2<Double>(x: -100.0, y: -100.0)), startPeriod: 0.8, endPeriod: 1.0))]]
                )
        }
    }

    func testUnion_interference_containment_edge_opposing_multiple() {
        // •>-----•
        // |      •>--•
        // |  1   | 2 |
        // |      •---•
        // |      |
        // |      •>--•
        // |      | 2 |
        // |      •---•
        // •------•
        let lhs = LinePolygon2Parametric.makeRectangle(width: 200, height: 500, center: .zero)
        let rhs1 = LinePolygon2Parametric.makeRectangle(width: 100, height: 100, center: .init(x: 150, y: -150))
        let rhs2 = LinePolygon2Parametric.makeRectangle(width: 100, height: 100, center: .init(x: 150, y: 150))
        let rhs = Union2Parametric.union(rhs1, rhs2)
        let sut = Union2Parametric(lhs, rhs, tolerance: accuracy)

        TestFixture.beginFixture { fixture in
            fixture.add(lhs, category: "input")
            fixture.add(rhs1, category: "input")
            fixture.add(rhs2, category: "input")
            fixture.assertions(on: sut)
                .assertAllSimplexes(
                    accuracy: accuracy,
                    [[GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: -100.0, y: -250.0), end: Vector2<Double>(x: 100.0, y: -250.0)), startPeriod: 0.0, endPeriod: 0.1111111111111111)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: 100.0, y: -250.0), end: Vector2<Double>(x: 100.0, y: -200.0)), startPeriod: 0.1111111111111111, endPeriod: 0.1388888888888889)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: 100.0, y: -200.0), end: Vector2<Double>(x: 200.0, y: -200.0)), startPeriod: 0.1388888888888889, endPeriod: 0.19444444444444445)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: 200.0, y: -200.0), end: Vector2<Double>(x: 200.0, y: -100.0)), startPeriod: 0.19444444444444445, endPeriod: 0.25)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: 200.0, y: -100.0), end: Vector2<Double>(x: 100.0, y: -100.0)), startPeriod: 0.25, endPeriod: 0.3055555555555556)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: 100.0, y: -100.0), end: Vector2<Double>(x: 100.0, y: 100.00000000000001)), startPeriod: 0.3055555555555556, endPeriod: 0.4166666666666667)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: 100.0, y: 100.00000000000001), end: Vector2<Double>(x: 200.0, y: 100.0)), startPeriod: 0.4166666666666667, endPeriod: 0.4722222222222222)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: 200.0, y: 100.0), end: Vector2<Double>(x: 200.0, y: 200.0)), startPeriod: 0.4722222222222222, endPeriod: 0.5277777777777778)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: 200.0, y: 200.0), end: Vector2<Double>(x: 100.0, y: 200.0)), startPeriod: 0.5277777777777778, endPeriod: 0.5833333333333334)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: 100.0, y: 200.0), end: Vector2<Double>(x: 100.0, y: 250.0)), startPeriod: 0.5833333333333334, endPeriod: 0.6111111111111112)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: 100.0, y: 250.0), end: Vector2<Double>(x: -100.0, y: 250.0)), startPeriod: 0.6111111111111112, endPeriod: 0.7222222222222222)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: -100.0, y: 250.0), end: Vector2<Double>(x: -100.0, y: -250.0)), startPeriod: 0.7222222222222222, endPeriod: 1.0))]]
                )
        }
    }

    func testUnion_interference_total() {
        let lhs = Circle2Parametric.makeTestCircle()
        let rhs = Circle2Parametric.makeTestCircle()
        let sut = Union2Parametric(lhs, rhs, tolerance: accuracy)

        TestFixture.beginFixture { fixture in
            fixture.assertions(on: sut)
                .assertAllSimplexes(
                    accuracy: accuracy,
                    [[Parametric2GeometrySimplex<Vector2<Double>>.circleArc2(CircleArc2Simplex<Vector2<Double>>(center: Vector2<Double>(x: 0.0, y: 0.0), radius: 100.0, startAngle: Angle<Double>(radians: 0.0), sweepAngle: Angle<Double>(radians: 1.5707963267948966), startPeriod: 0.0, endPeriod: 0.25)), Parametric2GeometrySimplex<Vector2<Double>>.circleArc2(CircleArc2Simplex<Vector2<Double>>(center: Vector2<Double>(x: 0.0, y: 0.0), radius: 100.0, startAngle: Angle<Double>(radians: 1.5707963267948966), sweepAngle: Angle<Double>(radians: 1.5707963267948966), startPeriod: 0.25, endPeriod: 0.5)), Parametric2GeometrySimplex<Vector2<Double>>.circleArc2(CircleArc2Simplex<Vector2<Double>>(center: Vector2<Double>(x: 0.0, y: 0.0), radius: 100.0, startAngle: Angle<Double>(radians: 3.141592653589793), sweepAngle: Angle<Double>(radians: 1.5707963267948966), startPeriod: 0.5, endPeriod: 0.75)), Parametric2GeometrySimplex<Vector2<Double>>.circleArc2(CircleArc2Simplex<Vector2<Double>>(center: Vector2<Double>(x: 0.0, y: 0.0), radius: 100.0, startAngle: Angle<Double>(radians: 4.71238898038469), sweepAngle: Angle<Double>(radians: 1.5707963267948966), startPeriod: 0.75, endPeriod: 1.0))]]
                )
        }
    }

    func testUnion_capsuleSequence_short() {
        let inputs = Capsule2Parametric.makeCapsuleSequence([
            (.init(x: -150, y: -10), 20.0),
            (.init(x:    0, y:  10), 17.5),
            (.init(x:  150, y: -10), 12.0),
        ])

        let sut = Union2Parametric(contours: inputs.flatMap({ $0.allContours() }), tolerance: accuracy)

        TestFixture.beginFixture(lineScale: 4.0, renderScale: 2.0) { fixture in
            fixture.assertions(on: sut)
                .assertAllSimplexes(
                    accuracy: accuracy,
                    [[GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: -150.0, y: -10.0), radius: 20.0, startAngle: Angle<Double>(radians: 1.6868266425111282), sweepAngle: Angle<Double>(radians: 1.5707963267948966)), startPeriod: 0.0, endPeriod: 0.04449467435514434)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: -150.0, y: -10.0), radius: 20.0, startAngle: Angle<Double>(radians: 3.257622969306025), sweepAngle: Angle<Double>(radians: 1.5707963267948966)), startPeriod: 0.04449467435514434, endPeriod: 0.08898934871028868)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: -150.0, y: -10.0), radius: 20.0, startAngle: Angle<Double>(radians: 4.828419296100922), sweepAngle: Angle<Double>(radians: 0.03304243316088362)), startPeriod: 0.08898934871028868, endPeriod: 0.08992531493220812)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: -147.02957541460717, y: -29.778184390446302), end: Vector2<Double>(x: 0.46609629892996085, y: -7.626263827477199)), startPeriod: 0.08992531493220812, endPeriod: 0.3011676746423419)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: 0.46609629892996085, y: -7.626263827477199), end: Vector2<Double>(x: 148.84739761402307, y: -21.94451789482691)), startPeriod: 0.3011676746423419, endPeriod: 0.5122976787319162)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: 150.0, y: -10.0), radius: 11.999999999999998, startAngle: Angle<Double>(radians: -1.6669948295818133), sweepAngle: Angle<Double>(radians: 1.5707963267948966)), startPeriod: 0.5122976787319162, endPeriod: 0.5389944833450028)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: 150.0, y: -10.0), radius: 11.999999999999998, startAngle: Angle<Double>(radians: -0.09619850278691677), sweepAngle: Angle<Double>(radians: 1.498090267775381)), startPeriod: 0.5389944833450028, endPeriod: 0.5644555965965034)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: 152.01723120693762, y: 1.8292340520321524), end: Vector2<Double>(x: 2.9417955101173607, y: 27.25096632588022)), startPeriod: 0.5644555965965034, endPeriod: 0.7786405057835739)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: 0.0, y: 10.0), radius: 17.5, startAngle: Angle<Double>(radians: 1.4018917649884644), sweepAngle: Angle<Double>(radians: 0.28493487752266383)), startPeriod: 0.7786405057835739, endPeriod: 0.7857027351923699)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: -2.0259774074152417, y: 27.382330555614313), end: Vector2<Double>(x: -152.3154027513317, y: 9.865520634987789)), startPeriod: 0.7857027351923699, endPeriod: 1.0))]]
                )
        }
    }

    func testUnion_capsuleSequence_short_2() {
        let inputs = Capsule2Parametric.makeCapsuleSequence([
            (.init(x: -150, y: -10), 20.0),
            (.init(x: -100, y:  10), 10.0),
            (.init(x:  -50, y: -30), 15.0),
        ])

        let sut = Union2Parametric(contours: inputs.flatMap({ $0.allContours() }), tolerance: accuracy)

        TestFixture.beginFixture(lineScale: 4.0, renderScale: 2.0) { fixture in
            fixture.add(inputs, category: "inputs")

            fixture.assertions(on: sut)
                .assertAllSimplexes(
                    accuracy: accuracy,
                    [[GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: -150.0, y: -10.0), radius: 20.000000000000007, startAngle: Angle<Double>(radians: 1.7645232428256685), sweepAngle: Angle<Double>(radians: 1.5707963267948966)), startPeriod: 0.0, endPeriod: 0.09088908963259965)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: -150.0, y: -10.0), radius: 20.000000000000007, startAngle: Angle<Double>(radians: 3.335319569620565), sweepAngle: Angle<Double>(radians: 1.5707963267948966)), startPeriod: 0.09088908963259965, endPeriod: 0.1817781792651993)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: -150.0, y: -10.0), radius: 20.000000000000007, startAngle: Angle<Double>(radians: 4.906115896415462), sweepAngle: Angle<Double>(radians: 0.37355892216318587)), startPeriod: 0.1817781792651993, endPeriod: 0.20339296775202034)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: -139.25309983154597, y: -26.867250421135108), end: Vector2<Double>(x: -101.173233625772, y: -2.604818173805065)), startPeriod: 0.20339296775202034, endPeriod: 0.3340229889906092)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: -101.173233625772, y: -2.604818173805065), end: Vector2<Double>(x: -60.256447805953925, y: -40.94555975744241)), startPeriod: 0.3340229889906092, endPeriod: 0.49624757488940224)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: -50.0, y: -30.0), radius: 14.999999999999995, startAngle: Angle<Double>(radians: -2.323703725089415), sweepAngle: Angle<Double>(radians: 1.5707963267948966)), startPeriod: 0.49624757488940224, endPeriod: 0.5644143921138519)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: -50.0, y: -30.0), radius: 14.999999999999995, startAngle: Angle<Double>(radians: -0.7529073982945182), sweepAngle: Angle<Double>(radians: 1.5707963267948966)), startPeriod: 0.5644143921138519, endPeriod: 0.6325812093383015)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: -50.0, y: -30.0), radius: 14.999999999999995, startAngle: Angle<Double>(radians: 0.8178889285003783), sweepAngle: Angle<Double>(radians: 0.15633291214193124)), startPeriod: 0.6325812093383015, endPeriod: 0.6393654861196774)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: -41.572820486729, y: -17.591025608411247), end: Vector2<Double>(x: -94.38188032448599, y: 18.272649594392494)), startPeriod: 0.6393654861196774, endPeriod: 0.824047961640725)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: -100.0, y: 10.0), radius: 10.000000000000005, startAngle: Angle<Double>(radians: 0.9742218406423091), sweepAngle: Angle<Double>(radians: 0.7903014021833594)), startPeriod: 0.824047961640725, endPeriod: 0.8469120891391564)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: -101.92517422215806, y: 19.812935555395143), end: Vector2<Double>(x: -153.85034844431613, y: 9.625871110790285)), startPeriod: 0.8469120891391564, endPeriod: 1.0))]]
                )
        }
    }

    func testUnion_capsuleSequence_short_3() {
        let polys: [Capsule2Parametric<Vector2D>] = [
            .init(
                start: .init(x: 840.9345087440722, y: 120.0420038990834),
                startRadius: 25.29491955052341,
                end: .init(x: 825.7795755118234, y: 294.99630400154695),
                endRadius: 40.07160791260946,
                startPeriod: 0.0,
                endPeriod: 1.0
            ),
            .init(
                start: .init(x: 825.7795755118234, y: 294.99630400154695),
                startRadius: 40.07160791260946,
                end: .init(x: 443.8865955891325, y: 214.2706642265273),
                endRadius: 36.77680233971253,
                startPeriod: 0.0,
                endPeriod: 1.0
            ),
        ]

        let sut = Union2Parametric(contours: polys.flatMap { $0.allContours() }, tolerance: 1e-5)

        TestFixture.beginFixture(lineScale: 1.0, renderScale: 0.45) { fixture in
            fixture.add(polys, category: "inputs")

            fixture.assertions(on: sut)
                .assertAllSimplexes(
                    accuracy: accuracy,
                    [[Parametric2GeometrySimplex<Vector2<Double>>.circleArc2(CircleArc2Simplex<Vector2<Double>>(center: Vector2<Double>(x: 840.9345087440722, y: 120.0420038990834), radius: 25.29491955052341, startAngle: Angle<Double>(radians: -2.970941306184629), sweepAngle: Angle<Double>(radians: 1.5707963267948966), startPeriod: 0.0, endPeriod: 0.03033636815053754)), Parametric2GeometrySimplex<Vector2<Double>>.circleArc2(CircleArc2Simplex<Vector2<Double>>(center: Vector2<Double>(x: 840.9345087440722, y: 120.0420038990834), radius: 25.29491955052341, startAngle: Angle<Double>(radians: -1.4001449793897325), sweepAngle: Angle<Double>(radians: 1.4023067425093831), startPeriod: 0.03033636815053754, endPeriod: 0.05741874215095776)), Parametric2GeometrySimplex<Vector2<Double>>.lineSegment2(LineSegment2Simplex<Vector2<Double>>(start: Vector2<Double>(x: 866.2293691902594, y: 120.09668548069239), end: Vector2<Double>(x: 865.8510897927539, y: 295.0829292582077), startPeriod: 0.05741874215095776, endPeriod: 0.19102147143202303)), Parametric2GeometrySimplex<Vector2<Double>>.circleArc2(CircleArc2Simplex<Vector2<Double>>(center: Vector2<Double>(x: 825.7795755118234, y: 294.99630400154695), radius: 40.07160791260946, startAngle: Angle<Double>(radians: 0.002161763119650789), sweepAngle: Angle<Double>(radians: 0.19771339814696445), startPeriod: 0.19102147143202303, endPeriod: 0.19707046714015988)), Parametric2GeometrySimplex<Vector2<Double>>.circleArc2(CircleArc2Simplex<Vector2<Double>>(center: Vector2<Double>(x: 825.7795755118234, y: 294.99630400154695), radius: 40.07160791260946, startAngle: Angle<Double>(radians: 0.19987516126661525), sweepAngle: Angle<Double>(radians: 1.373082928647932), startPeriod: 0.19707046714015988, endPeriod: 0.2390796219073725)), Parametric2GeometrySimplex<Vector2<Double>>.circleArc2(CircleArc2Simplex<Vector2<Double>>(center: Vector2<Double>(x: 825.7795755118234, y: 294.99630400154695), radius: 40.07160791260946, startAngle: Angle<Double>(radians: 1.5729580899145474), sweepAngle: Angle<Double>(radians: 0.21459567676896898), startPeriod: 0.2390796219073725, endPeriod: 0.2456451270270373)), Parametric2GeometrySimplex<Vector2<Double>>.lineSegment2(LineSegment2Simplex<Vector2<Double>>(start: Vector2<Double>(x: 817.1616122130969, y: 334.1302338998297), end: Vector2<Double>(x: 435.9772266040055, y: 250.1868871987636), startPeriod: 0.2456451270270373, endPeriod: 0.5436537396120984)), Parametric2GeometrySimplex<Vector2<Double>>.circleArc2(CircleArc2Simplex<Vector2<Double>>(center: Vector2<Double>(x: 443.8865955891325, y: 214.2706642265273), radius: 36.77680233971253, startAngle: Angle<Double>(radians: 1.7875537666835175), sweepAngle: Angle<Double>(radians: 1.5707963267948966), startPeriod: 0.5436537396120984, endPeriod: 0.5877604074727591)), Parametric2GeometrySimplex<Vector2<Double>>.circleArc2(CircleArc2Simplex<Vector2<Double>>(center: Vector2<Double>(x: 443.8865955891325, y: 214.2706642265273), radius: 36.77680233971253, startAngle: Angle<Double>(radians: 3.358350093478414), sweepAngle: Angle<Double>(radians: 1.5539140481728904), startPeriod: 0.5877604074727591, endPeriod: 0.6313930348463052)), Parametric2GeometrySimplex<Vector2<Double>>.lineSegment2(LineSegment2Simplex<Vector2<Double>>(start: Vector2<Double>(x: 451.18851859011914, y: 178.2260375698126), end: Vector2<Double>(x: 793.297000370629, y: 247.5303978489986), startPeriod: 0.6313930348463052, endPeriod: 0.8978994590751505)), Parametric2GeometrySimplex<Vector2<Double>>.lineSegment2(LineSegment2Simplex<Vector2<Double>>(start: Vector2<Double>(x: 793.297000370629, y: 247.5303978489986), end: Vector2<Double>(x: 816.0070140542555, y: 115.74631262099889), startPeriod: 0.8978994590751505, endPeriod: 1.0))]]
                )
        }
    }

    func testUnion_capsuleSequence_short_4() {
        let polys: [Capsule2Parametric<Vector2D>] = [
            .init(
                start: .init(x: 383.64632586005933, y: 479.1698027819917),
                startRadius: 38.20812109867896,
                end: .init(x: 413.9206126268281, y: 346.55323949845405),
                endRadius: 44.37203387937886,
                startPeriod: 0.0,
                endPeriod: 1.0
            ),
            .init(
                start: .init(x: 413.9206126268281, y: 346.55323949845405),
                startRadius: 44.37203387937886,
                end: .init(x: 363.3047015276526, y: 90.86607922113856),
                endRadius: 29.084343656532283,
                startPeriod: 0.0,
                endPeriod: 1.0
            ),
        ]

        let sut = Union2Parametric(contours: polys.flatMap { $0.allContours() }, tolerance: 1e-5)

        TestFixture.beginFixture(lineScale: 1.0, renderScale: 0.45) { fixture in
            fixture.add(polys, category: "inputs")

            fixture.assertions(on: sut)
                .assertAllSimplexes(
                    accuracy: accuracy,
                    [[Parametric2GeometrySimplex<Vector2<Double>>.circleArc2(CircleArc2Simplex<Vector2<Double>>(center: Vector2<Double>(x: 383.64632586005933, y: 479.1698027819917), radius: 38.20812109867896, startAngle: Angle<Double>(radians: 0.2697673288048176), sweepAngle: Angle<Double>(radians: 1.5707963267948966), startPeriod: 0.0, endPeriod: 0.05966998231698433)), Parametric2GeometrySimplex<Vector2<Double>>.circleArc2(CircleArc2Simplex<Vector2<Double>>(center: Vector2<Double>(x: 383.64632586005933, y: 479.1698027819917), radius: 38.20812109867896, startAngle: Angle<Double>(radians: 1.840563655599714), sweepAngle: Angle<Double>(radians: 1.480138334001115), startPeriod: 0.05966998231698433, endPeriod: 0.11589613125174011)), Parametric2GeometrySimplex<Vector2<Double>>.lineSegment2(LineSegment2Simplex<Vector2<Double>>(start: Vector2<Double>(x: 346.0494293313477, y: 472.3629026578039), end: Vector2<Double>(x: 368.99949778919733, y: 345.6016261010133), startPeriod: 0.11589613125174011, endPeriod: 0.24397298164718195)), Parametric2GeometrySimplex<Vector2<Double>>.lineSegment2(LineSegment2Simplex<Vector2<Double>>(start: Vector2<Double>(x: 368.99949778919733, y: 345.6016261010133), end: Vector2<Double>(x: 334.491871107606, y: 94.8309057137998), startPeriod: 0.24397298164718195, endPeriod: 0.4956424446617653)), Parametric2GeometrySimplex<Vector2<Double>>.circleArc2(CircleArc2Simplex<Vector2<Double>>(center: Vector2<Double>(x: 363.3047015276526, y: 90.86607922113856), radius: 29.084343656532283, startAngle: Angle<Double>(radians: 3.004845181863982), sweepAngle: Angle<Double>(radians: 1.5707963267948966), startPeriod: 0.4956424446617653, endPeriod: 0.5410637378785725)), Parametric2GeometrySimplex<Vector2<Double>>.circleArc2(CircleArc2Simplex<Vector2<Double>>(center: Vector2<Double>(x: 363.3047015276526, y: 90.86607922113856), radius: 29.084343656532283, startAngle: Angle<Double>(radians: 4.575641508658879), sweepAngle: Angle<Double>(radians: 1.4534241535196921), startPeriod: 0.5410637378785725, endPeriod: 0.5830910863764582)), Parametric2GeometrySimplex<Vector2<Double>>.lineSegment2(LineSegment2Simplex<Vector2<Double>>(start: Vector2<Double>(x: 391.45500108584906, y: 83.55446649103085), end: Vector2<Double>(x: 456.8676380251618, y: 335.39840198159055), startPeriod: 0.5830910863764582, endPeriod: 0.841786122029611)), Parametric2GeometrySimplex<Vector2<Double>>.circleArc2(CircleArc2Simplex<Vector2<Double>>(center: Vector2<Double>(x: 413.9206126268281, y: 346.55323949845405), radius: 44.37203387937886, startAngle: Angle<Double>(radians: -0.25411964500101614), sweepAngle: Angle<Double>(radians: 0.2541196450010158), startPeriod: 0.841786122029611, endPeriod: 0.852996698007906)), Parametric2GeometrySimplex<Vector2<Double>>.circleArc2(CircleArc2Simplex<Vector2<Double>>(center: Vector2<Double>(x: 413.9206126268281, y: 346.55323949845405), radius: 44.37203387937886, startAngle: Angle<Double>(radians: -2.220446049250313e-16), sweepAngle: Angle<Double>(radians: 0.17910933601103649), startPeriod: 0.852996698007906, endPeriod: 0.8608981682770215)), Parametric2GeometrySimplex<Vector2<Double>>.circleArc2(CircleArc2Simplex<Vector2<Double>>(center: Vector2<Double>(x: 413.9206126268281, y: 346.55323949845405), radius: 44.37203387937886, startAngle: Angle<Double>(radians: 0.1791093360110363), sweepAngle: Angle<Double>(radians: 0.09065799279378162), startPeriod: 0.8608981682770215, endPeriod: 0.864897576965989)), Parametric2GeometrySimplex<Vector2<Double>>.lineSegment2(LineSegment2Simplex<Vector2<Double>>(start: Vector2<Double>(x: 456.68784009523006, y: 358.37870546215737), end: Vector2<Double>(x: 420.47257120660976, y: 489.3525416850074), startPeriod: 0.864897576965989, endPeriod: 1.0))]]
                )
        }
    }

    func testUnion_capsuleSequence_long() {
        let inputs = Capsule2Parametric.makeCapsuleSequence([
            (.init(x: -150, y: -10), 20.0),
            (.init(x: -100, y:  10), 10.0),
            (.init(x:  -50, y: -30), 15.0),
            (.init(x:    0, y:  10), 17.5),
            (.init(x:   50, y:  40), 12.5),
            (.init(x:  100, y:   0), 10.0),
            (.init(x:  150, y:  25), 12.0),
        ])

        let sut = Union2Parametric(contours: inputs.flatMap({ $0.allContours() }), tolerance: accuracy)

        TestFixture.beginFixture(lineScale: 4.0, renderScale: 2.0) { fixture in
            fixture.add(inputs, category: "inputs")

            fixture.assertions(on: sut)
                .assertAllSimplexes(
                    accuracy: accuracy,
                    [[GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: -150.0, y: -10.0), radius: 20.0, startAngle: Angle<Double>(radians: 1.7645232428256685), sweepAngle: Angle<Double>(radians: 1.5707963267948966)), startPeriod: 0.0, endPeriod: 0.03860227068267194)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: -150.0, y: -10.0), radius: 20.0, startAngle: Angle<Double>(radians: 3.335319569620565), sweepAngle: Angle<Double>(radians: 1.5707963267948966)), startPeriod: 0.03860227068267194, endPeriod: 0.07720454136534388)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: -150.0, y: -10.0), radius: 20.0, startAngle: Angle<Double>(radians: 4.906115896415462), sweepAngle: Angle<Double>(radians: 0.37355892216318587)), startPeriod: 0.07720454136534388, endPeriod: 0.0863847402130799)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: -139.25309983154597, y: -26.867250421135108), end: Vector2<Double>(x: -101.173233625772, y: -2.604818173805065)), startPeriod: 0.0863847402130799, endPeriod: 0.1418657166374112)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: -101.173233625772, y: -2.604818173805065), end: Vector2<Double>(x: -60.256447805953925, y: -40.94555975744241)), startPeriod: 0.1418657166374112, endPeriod: 0.21076548669301828)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: -50.0, y: -30.0), radius: 15.0, startAngle: Angle<Double>(radians: -2.323703725089415), sweepAngle: Angle<Double>(radians: 1.3885949736618612)), startPeriod: 0.21076548669301828, endPeriod: 0.23635899528203408)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: -41.09403617653436, y: -42.06995477933208), end: Vector2<Double>(x: 10.324013069283804, y: -4.130517985371452)), startPeriod: 0.23635899528203408, endPeriod: 0.314876084478879)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: 10.324013069283804, y: -4.130517985371452), end: Vector2<Double>(x: 49.92713695407643, y: 24.519321922490473)), startPeriod: 0.314876084478879, endPeriod: 0.3749368851924292)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: 49.92713695407643, y: 24.519321922490473), end: Vector2<Double>(x: 94.06269078435623, y: -8.046636519554715)), startPeriod: 0.3749368851924292, endPeriod: 0.4423333591480425)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: 100.0, y: 0.0), radius: 10.0, startAngle: Angle<Double>(radians: -2.2064839021622404), sweepAngle: Angle<Double>(radians: 1.0635504598831482)), startPeriod: 0.4423333591480425, endPeriod: 0.4554017188191083)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: 104.14927287150829, y: -9.098545743016594), end: Vector2<Double>(x: 154.97912744580995, y: 14.08174510838009)), startPeriod: 0.4554017188191083, endPeriod: 0.5240468696089268)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: 150.0, y: 25.0), radius: 12.0, startAngle: Angle<Double>(radians: -1.1429334422790915), sweepAngle: Angle<Double>(radians: 1.5707963267948966)), startPeriod: 0.5240468696089268, endPeriod: 0.5472082320185299)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: 150.0, y: 25.0), radius: 12.0, startAngle: Angle<Double>(radians: 0.427862884515805), sweepAngle: Angle<Double>(radians: 1.5707963267948966)), startPeriod: 0.5472082320185299, endPeriod: 0.5703695944281331)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: 150.0, y: 25.0), radius: 12.0, startAngle: Angle<Double>(radians: 1.9986592113107016), sweepAngle: Angle<Double>(radians: 0.07156944897000184)), startPeriod: 0.5703695944281331, endPeriod: 0.5714248846123366)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: 144.25287255419005, y: 35.53425489161991), end: Vector2<Double>(x: 101.30206975776143, y: 12.101772944814893)), startPeriod: 0.5714248846123366, endPeriod: 0.6315438763267498)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: 101.30206975776143, y: 12.101772944814893), end: Vector2<Double>(x: 58.18383164150594, y: 49.448539551882405)), startPeriod: 0.6315438763267498, endPeriod: 0.7016360152702935)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: 50.0, y: 40.0), radius: 12.5, startAngle: Angle<Double>(radians: 0.8570020177151347), sweepAngle: Angle<Double>(radians: 1.1683590826247927)), startPeriod: 0.7016360152702935, endPeriod: 0.7195812577536342)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: 44.511608434583316, y: 51.2306526090278), end: Vector2<Double>(x: -7.683748191583341, y: 25.722913652638933)), startPeriod: 0.7195812577536342, endPeriod: 0.790965091352626)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: 0.0, y: 10.0), radius: 17.5, startAngle: Angle<Double>(radians: 2.025361100339926), sweepAngle: Angle<Double>(radians: 0.18112280182231472)), startPeriod: 0.790965091352626, endPeriod: 0.794859792651927)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: 0.0, y: 10.0), radius: 17.5, startAngle: Angle<Double>(radians: 2.206483902162241), sweepAngle: Angle<Double>(radians: 0.07810673371241661)), startPeriod: 0.794859792651927, endPeriod: 0.7965393293762558)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: -11.457364298108304, y: 23.227955372635382), end: Vector2<Double>(x: -51.108091807497736, y: -11.115434589194493)), startPeriod: 0.7965393293762558, endPeriod: 0.8609947529561205)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: -51.108091807497736, y: -11.115434589194493), end: Vector2<Double>(x: -94.381880324486, y: 18.272649594392504)), startPeriod: 0.8609947529561205, endPeriod: 0.9252699280038071)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.circleArc2(GeometriaClipping.CircleArc2Simplex<Geometria.Vector2<Swift.Double>>(circleArc: CircleArc2<Vector2<Double>>(center: Vector2<Double>(x: -100.0, y: 10.0), radius: 10.0, startAngle: Angle<Double>(radians: 0.9742218406423099), sweepAngle: Angle<Double>(radians: 0.790301402183359)), startPeriod: 0.9252699280038071, endPeriod: 0.9349807441445048)), GeometriaClipping.Parametric2GeometrySimplex<Geometria.Vector2<Swift.Double>>.lineSegment2(GeometriaClipping.LineSegment2Simplex<Geometria.Vector2<Swift.Double>>(lineSegment: LineSegment<Vector2<Double>>(start: Vector2<Double>(x: -101.92517422215806, y: 19.812935555395143), end: Vector2<Double>(x: -153.85034844431613, y: 9.625871110790278)), startPeriod: 0.9349807441445048, endPeriod: 1.0))]]
                )
        }
    }

    func testUnion_capsuleSequence_long_2() {
        let inputs: [Capsule2Parametric<Vector2D>] = [
            .init(start: .init(x: 831.0856706638862, y: 439.51739502930883), startRadius: 38.177972094185236, end: .init(x: 531.0283832704459, y: 641.1637056008453), endRadius: 28.087068559000635, startPeriod: 0.0, endPeriod: 1.0),
            .init(start: .init(x: 531.0283832704459, y: 641.1637056008453), startRadius: 28.087068559000635, end: .init(x: 828.9744951679345, y: 628.3752785619234), endRadius: 42.41916425894468, startPeriod: 0.0, endPeriod: 1.0),
            .init(start: .init(x: 828.9744951679345, y: 628.3752785619234), startRadius: 42.41916425894468, end: .init(x: 308.7826460852438, y: 54.76757704896331), endRadius: 28.510982140034347, startPeriod: 0.0, endPeriod: 1.0),
            .init(start: .init(x: 308.7826460852438, y: 54.76757704896331), startRadius: 28.510982140034347, end: .init(x: 522.4062407262397, y: 629.7358294419389), endRadius: 46.87878455509802, startPeriod: 0.0, endPeriod: 1.0),
            .init(start: .init(x: 522.4062407262397, y: 629.7358294419389), startRadius: 46.87878455509802, end: .init(x: 789.42846959348, y: 109.09043397254594), endRadius: 26.46207191684884, startPeriod: 0.0, endPeriod: 1.0),
            .init(start: .init(x: 789.42846959348, y: 109.09043397254594), startRadius: 26.46207191684884, end: .init(x: 451.41732460961, y: 634.6083676384558), endRadius: 33.610161029869225, startPeriod: 0.0, endPeriod: 1.0)
        ]

        let sut = Union2Parametric(contours: inputs.flatMap({ $0.allContours() }), tolerance: 1e-5)

        TestFixture.beginFixture(lineScale: 1.0, renderScale: 0.45) { fixture in
            fixture.add(inputs, category: "inputs")

            fixture.assertions(on: sut)
                .assertAllSimplexes(
                    accuracy: accuracy,
                    [[Parametric2GeometrySimplex<Vector2<Double>>.circleArc2(CircleArc2Simplex<Vector2<Double>>(center: Vector2<Double>(x: 831.0856706638862, y: 439.51739502930883), radius: 38.177972094185236, startAngle: Angle<Double>(radians: -2.1904162719690725), sweepAngle: Angle<Double>(radians: 1.5707963267948966), startPeriod: 0.0, endPeriod: 0.02130535759547289)), Parametric2GeometrySimplex<Vector2<Double>>.circleArc2(CircleArc2Simplex<Vector2<Double>>(center: Vector2<Double>(x: 831.0856706638862, y: 439.51739502930883), radius: 38.177972094185236, startAngle: Angle<Double>(radians: -0.619619945174176), sweepAngle: Angle<Double>(radians: 1.5707963267948966), startPeriod: 0.02130535759547289, endPeriod: 0.04261071519094578)), Parametric2GeometrySimplex<Vector2<Double>>.circleArc2(CircleArc2Simplex<Vector2<Double>>(center: Vector2<Double>(x: 831.0856706638862, y: 439.51739502930883), radius: 38.177972094185236, startAngle: Angle<Double>(radians: 0.9511763816207206), sweepAngle: Angle<Double>(radians: 0.05583235666827724), startPeriod: 0.04261071519094578, endPeriod: 0.043367992441932735)), Parametric2GeometrySimplex<Vector2<Double>>.lineSegment2(LineSegment2Simplex<Vector2<Double>>(start: Vector2<Double>(x: 851.4876519116439, y: 471.78683435493906), end: Vector2<Double>(x: 781.5502310716097, y: 516.0039629544316), startPeriod: 0.043367992441932735, endPeriod: 0.07276391831128086)), Parametric2GeometrySimplex<Vector2<Double>>.lineSegment2(LineSegment2Simplex<Vector2<Double>>(start: Vector2<Double>(x: 781.5502310716097, y: 516.0039629544316), end: Vector2<Double>(x: 859.8798439137527, y: 599.3193856083988), startPeriod: 0.07276391831128086, endPeriod: 0.11339046943271326)), Parametric2GeometrySimplex<Vector2<Double>>.circleArc2(CircleArc2Simplex<Vector2<Double>>(center: Vector2<Double>(x: 828.9744951679345, y: 628.3752785619234), radius: 42.41916425894468, startAngle: Angle<Double>(radians: -0.7545637514903484), sweepAngle: Angle<Double>(radians: 0.754563751490348), startPeriod: 0.11339046943271326, endPeriod: 0.12476187478146346)), Parametric2GeometrySimplex<Vector2<Double>>.circleArc2(CircleArc2Simplex<Vector2<Double>>(center: Vector2<Double>(x: 828.9744951679345, y: 628.3752785619234), radius: 42.41916425894468, startAngle: Angle<Double>(radians: -3.191891195797325e-16), sweepAngle: Angle<Double>(radians: 1.479823459912622), startPeriod: 0.12476187478146346, endPeriod: 0.14706306851628023)), Parametric2GeometrySimplex<Vector2<Double>>.circleArc2(CircleArc2Simplex<Vector2<Double>>(center: Vector2<Double>(x: 828.9744951679345, y: 628.3752785619234), radius: 42.41916425894468, startAngle: Angle<Double>(radians: 1.4798234599126219), sweepAngle: Angle<Double>(radians: 0.0961544993579948), startPeriod: 0.14706306851628023, endPeriod: 0.14851213333836621)), Parametric2GeometrySimplex<Vector2<Double>>.lineSegment2(LineSegment2Simplex<Vector2<Double>>(start: Vector2<Double>(x: 828.7546956323984, y: 670.7938733593883), end: Vector2<Double>(x: 547.4942764208841, y: 669.336472193636), startPeriod: 0.14851213333836621, endPeriod: 0.24843630222569446)), Parametric2GeometrySimplex<Vector2<Double>>.circleArc2(CircleArc2Simplex<Vector2<Double>>(center: Vector2<Double>(x: 522.4062407262397, y: 629.7358294419389), radius: 46.87878455509802, startAngle: Angle<Double>(radians: 1.0060894551062145), sweepAngle: Angle<Double>(radians: 0.17902307889011831), startPeriod: 0.24843630222569446, endPeriod: 0.2514178478521858)), Parametric2GeometrySimplex<Vector2<Double>>.circleArc2(CircleArc2Simplex<Vector2<Double>>(center: Vector2<Double>(x: 522.4062407262397, y: 629.7358294419389), radius: 46.87878455509802, startAngle: Angle<Double>(radians: 1.1851125339963327), sweepAngle: Angle<Double>(radians: 1.4818346590978244), startPeriod: 0.2514178478521858, endPeriod: 0.2760971108522833)), Parametric2GeometrySimplex<Vector2<Double>>.lineSegment2(LineSegment2Simplex<Vector2<Double>>(start: Vector2<Double>(x: 480.7096803038677, y: 651.1605182449712), end: Vector2<Double>(x: 479.89125598865695, y: 652.4655274427209), startPeriod: 0.2760971108522833, endPeriod: 0.2766443697438511)), Parametric2GeometrySimplex<Vector2<Double>>.circleArc2(CircleArc2Simplex<Vector2<Double>>(center: Vector2<Double>(x: 451.41732460961, y: 634.6083676384558), radius: 33.610161029869225, startAngle: Angle<Double>(radians: 0.560137177660685), sweepAngle: Angle<Double>(radians: 1.5707963267948966), startPeriod: 0.2766443697438511, endPeriod: 0.2954006435924522)), Parametric2GeometrySimplex<Vector2<Double>>.circleArc2(CircleArc2Simplex<Vector2<Double>>(center: Vector2<Double>(x: 451.41732460961, y: 634.6083676384558), radius: 33.610161029869225, startAngle: Angle<Double>(radians: 2.1309335044555815), sweepAngle: Angle<Double>(radians: 1.5707963267948966), startPeriod: 0.2954006435924522, endPeriod: 0.3141569174410534)), Parametric2GeometrySimplex<Vector2<Double>>.circleArc2(CircleArc2Simplex<Vector2<Double>>(center: Vector2<Double>(x: 451.41732460961, y: 634.6083676384558), radius: 33.610161029869225, startAngle: Angle<Double>(radians: 3.701729831250478), sweepAngle: Angle<Double>(radians: 0.022880370177983167), startPeriod: 0.3141569174410534, endPeriod: 0.31443012312755464)), Parametric2GeometrySimplex<Vector2<Double>>.lineSegment2(LineSegment2Simplex<Vector2<Double>>(start: Vector2<Double>(x: 423.3593888967357, y: 616.1044445953291), end: Vector2<Double>(x: 453.0902801069541, y: 571.0227917848118), startPeriod: 0.31443012312755464, endPeriod: 0.3336155206465875)), Parametric2GeometrySimplex<Vector2<Double>>.lineSegment2(LineSegment2Simplex<Vector2<Double>>(start: Vector2<Double>(x: 453.0902801069541, y: 571.0227917848118), end: Vector2<Double>(x: 281.77133402103664, y: 63.89254955080534), startPeriod: 0.3336155206465875, endPeriod: 0.523785562660637)), Parametric2GeometrySimplex<Vector2<Double>>.circleArc2(CircleArc2Simplex<Vector2<Double>>(center: Vector2<Double>(x: 308.7826460852438, y: 54.76757704896331), radius: 28.510982140034347, startAngle: Angle<Double>(radians: 2.8158091813672375), sweepAngle: Angle<Double>(radians: 1.5707963267948961), startPeriod: 0.523785562660637, endPeriod: 0.5396962209950563)), Parametric2GeometrySimplex<Vector2<Double>>.circleArc2(CircleArc2Simplex<Vector2<Double>>(center: Vector2<Double>(x: 308.7826460852438, y: 54.76757704896331), radius: 28.510982140034347, startAngle: Angle<Double>(radians: 4.386605508162133), sweepAngle: Angle<Double>(radians: 1.1420160475271035), startPeriod: 0.5396962209950563, endPeriod: 0.5512637468637364)), Parametric2GeometrySimplex<Vector2<Double>>.lineSegment2(LineSegment2Simplex<Vector2<Double>>(start: Vector2<Double>(x: 329.5549046036976, y: 35.238384064308725), end: Vector2<Double>(x: 609.830463901581, y: 333.35394770867254), startPeriod: 0.5512637468637364, endPeriod: 0.6966318768052301)), Parametric2GeometrySimplex<Vector2<Double>>.lineSegment2(LineSegment2Simplex<Vector2<Double>>(start: Vector2<Double>(x: 609.830463901581, y: 333.35394770867254), end: Vector2<Double>(x: 767.3377955258202, y: 94.52185925265988), startPeriod: 0.6966318768052301, endPeriod: 0.7982716409147761)), Parametric2GeometrySimplex<Vector2<Double>>.circleArc2(CircleArc2Simplex<Vector2<Double>>(center: Vector2<Double>(x: 789.42846959348, y: 109.09043397254594), radius: 26.46207191684884, startAngle: Angle<Double>(radians: -2.558575105751127), sweepAngle: Angle<Double>(radians: 1.4965674395910742), startPeriod: 0.7982716409147761, endPeriod: 0.8123410621427004)), Parametric2GeometrySimplex<Vector2<Double>>.circleArc2(CircleArc2Simplex<Vector2<Double>>(center: Vector2<Double>(x: 789.42846959348, y: 109.09043397254594), radius: 26.46207191684884, startAngle: Angle<Double>(radians: -1.0620076661600528), sweepAngle: Angle<Double>(radians: 1.5009964684103179), startPeriod: 0.8123410621427004, endPeriod: 0.826452121235007)), Parametric2GeometrySimplex<Vector2<Double>>.lineSegment2(LineSegment2Simplex<Vector2<Double>>(start: Vector2<Double>(x: 813.3814583834491, y: 120.33745927526913), end: Vector2<Double>(x: 678.8765533896855, y: 406.7949353450885), startPeriod: 0.826452121235007, endPeriod: 0.9388816499001781)), Parametric2GeometrySimplex<Vector2<Double>>.lineSegment2(LineSegment2Simplex<Vector2<Double>>(start: Vector2<Double>(x: 678.8765533896855, y: 406.7949353450885), end: Vector2<Double>(x: 732.0016688411663, y: 463.3015525334168), startPeriod: 0.9388816499001781, endPeriod: 0.9664355996825058)), Parametric2GeometrySimplex<Vector2<Double>>.lineSegment2(LineSegment2Simplex<Vector2<Double>>(start: Vector2<Double>(x: 732.0016688411663, y: 463.3015525334168), end: Vector2<Double>(x: 808.9147372715075, y: 408.4367376080911), startPeriod: 0.9664355996825058, endPeriod: 1.0))], [Parametric2GeometrySimplex<Vector2<Double>>.lineSegment2(LineSegment2Simplex<Vector2<Double>>(start: Vector2<Double>(x: 712.5102946799935, y: 559.6536673510426), end: Vector2<Double>(x: 644.580946659623, y: 602.6012150446663), startPeriod: 0.0, endPeriod: 0.359281646777574)), Parametric2GeometrySimplex<Vector2<Double>>.lineSegment2(LineSegment2Simplex<Vector2<Double>>(start: Vector2<Double>(x: 644.580946659623, y: 602.6012150446663), end: Vector2<Double>(x: 742.2795183653387, y: 593.6886954536868), startPeriod: 0.359281646777574, endPeriod: 0.7978567487318653)), Parametric2GeometrySimplex<Vector2<Double>>.lineSegment2(LineSegment2Simplex<Vector2<Double>>(start: Vector2<Double>(x: 742.2795183653387, y: 593.6886954536868), end: Vector2<Double>(x: 712.5102946799935, y: 559.6536673510426), startPeriod: 0.7978567487318653, endPeriod: 1.0))], [Parametric2GeometrySimplex<Vector2<Double>>.lineSegment2(LineSegment2Simplex<Vector2<Double>>(start: Vector2<Double>(x: 612.2260143039459, y: 548.741767738145), end: Vector2<Double>(x: 668.1028605691226, y: 508.8828348998807), startPeriod: 0.0, endPeriod: 0.38144029811323993)), Parametric2GeometrySimplex<Vector2<Double>>.lineSegment2(LineSegment2Simplex<Vector2<Double>>(start: Vector2<Double>(x: 668.1028605691226, y: 508.8828348998807), end: Vector2<Double>(x: 643.9223994358708, y: 481.23741549278157), startPeriod: 0.38144029811323993, endPeriod: 0.585554016017132)), Parametric2GeometrySimplex<Vector2<Double>>.lineSegment2(LineSegment2Simplex<Vector2<Double>>(start: Vector2<Double>(x: 643.9223994358708, y: 481.23741549278157), end: Vector2<Double>(x: 612.2260143039459, y: 548.741767738145), startPeriod: 0.585554016017132, endPeriod: 1.0))], [Parametric2GeometrySimplex<Vector2<Double>>.lineSegment2(LineSegment2Simplex<Vector2<Double>>(start: Vector2<Double>(x: 568.8823866252565, y: 395.44448478598156), end: Vector2<Double>(x: 399.0296339946152, y: 201.2525478312665), startPeriod: 0.0, endPeriod: 0.389671432045912)), Parametric2GeometrySimplex<Vector2<Double>>.lineSegment2(LineSegment2Simplex<Vector2<Double>>(start: Vector2<Double>(x: 399.0296339946152, y: 201.2525478312665), end: Vector2<Double>(x: 512.5539879058978, y: 480.8565666668551), startPeriod: 0.389671432045912, endPeriod: 0.8454658114925583)), Parametric2GeometrySimplex<Vector2<Double>>.lineSegment2(LineSegment2Simplex<Vector2<Double>>(start: Vector2<Double>(x: 512.5539879058978, y: 480.8565666668551), end: Vector2<Double>(x: 568.8823866252565, y: 395.44448478598156), startPeriod: 0.8454658114925583, endPeriod: 1.0))]]
                )
        }
    }

    #if GEOMETRIA_PERFORMANCE_TESTS

    func testPerformance_overlapping_circles() {
        let inputs = (0...10).map { offset in
            return Circle2Parametric.makeTestCircle(center: .init(x: Double(offset), y: 0.0), radius: 10.0)
        }

        measure {
            _ = union(inputs)
        }
    }

    #endif // #if GEOMETRIA_PERFORMANCE_TESTS
}
